(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{171:function(e,t,n){"use strict";n.r(t),function(e){n(173),n(175),n(176),n(178);var t=n(166),a=n.n(t),i=n(11),l=n.n(i),o=(n(450),n(99)),s=n(167),r=n(168);document.addEventListener("touchstart",function e(t){document.documentElement.classList.add("can-touch"),document.removeEventListener("touchstart",e,!1)},!1);var d=n(179),u=n(218),c=(n(219),n(333)),m=n(402);const h=Object.assign({},n(21),n(456),n(2),n(455),n(5),n(71),n(454),n(453));o.b.add(s.a,r.a),o.a.watch(),window.addEventListener("load",function(){document.getElementById("main_div").style.display="block"});function f(e,t){return new Promise(function(n,a){var i=new FileReader;i.onload=(i=>{var o=i.target.result;d.detect(o);let s,r={};l.a.parse(o,{header:!0,dynamicTyping:!0,skipEmptyLines:!0,chunk:function(t,i){(s=function(e,t){var n;return e.forEach(function(e,a){if(v[v.indexOf(e.trim())],-1===v.indexOf(e.trim())){var i=document.createElement("div"),l=document.createElement("p");e=e&&" "!==e?e:"au moins une colonne ou un entête vide",l.innerHTML="<h4 Fichier concerné:<br><b>"+t.name+"</b><br><br>Entête concerné:<br><b>"+e+"</b></h4><hr>",l.innerHTML+='<h4 style="color:red"> <i class="fa fa-warning"></i><br>entêtes en cours au '+(new Date).toLocaleDateString()+"</h4><br><br>",l.innerHTML+=JSON.stringify(v.map(e=>"["+e+"]").join(", ")),i.appendChild(l),function(e,t,n,a){swal({title:e,text:t,content:n,icon:a,className:"sweetalert-lg"}).then(e=>{setTimeout(()=>window.location.href=window.location.href,10)})}("Contrôle entête de colonnes","Oups! Apparemment, un entête de colonne n'est pas conforme au modèle attendu... ",i,"warning"),n=!1}else n=!0}),n}(t.meta.fields,e))?(r[e.name]=t.data,r.headers=t.meta.fields,n(r)):a("erreur entêtes de colonnes")},complete:function(n){-1!==t.indexOf(e.name)&&D("Information doublons","Oups! Apparement au moins 1 doublons dans la sélection... "+e.name,"warning"),t.push(e.name)}})}),i.onprogress=(e=>{}),i.readAsText(e,"UTF-8"),0})}function g(e,t){for(var n,a=[],i=0,l=e.length;i<l;i++)n=e[i][t],a.push(n);return k(a)}fileInput.onchange=function(t){document.getElementById("spinnerLoad-span").classList.replace("hidden","inline"),this.disabled=!0;var n=[...fileInput.files];(n=n.sort(function(e,t){return e=C.test(e.name)?e.name.match(C)[0]:e.name,t=C.test(t.name)?t.name.match(C)[0]:t.name,E[e]-E[t]})).map(e=>e.size).reduce((e,t)=>e+=t);let a=[],i=[];for(var o=0,s=n.length;o<s;o++){if(!C.test(n[o].name))return D("Information erreur","Oups! Apparmment, il y a une erreur dans le type de titre attendu...","warning");a.push(f(n[o],i))}Promise.all(a).then(function(t){if(i.length<=17){document.getElementById("filesNumber").classList.remove("hidden"),document.getElementById("filesNumber").innerHTML=i.length;let n=[...new Set([].concat(...t.map(e=>e.headers)))];!function(t,n){document.getElementById("grade_report-div").classList.replace("inline","hidden"),document.getElementById("profil_info-div").classList.replace("hidden","inline"),document.getElementById("spinnerLoad-span").classList.replace("inline","hidden"),function(t,n){return new Promise(function(a){var i=[],o=[];t.length>1?t.forEach(e=>{i.push(e[Object.keys(e)[0]].map(t=>(x.test(Object.keys(e)[0])&&(t["filename imported"]=Object.keys(e)[0].match(x)[0].replace(/SPE\-/,"").replace(/[\_\d]{2}/g,"").replace(/\_/g,"")),t)))}):i.push(t[0][Object.keys(t[0])[0]].map(e=>(x.test(Object.keys(t[0])[0])&&(e["filename imported"]=Object.keys(t[0])[0].match(x)[0].replace(/SPE\-/,"").replace(/[\_\d]{2}/g,"").replace(/\_/g,"")),e)));var s=[].concat(...i),r={};n.forEach((e,t)=>{r[e]=""});for(var d=0,u=s.length;d<u;d++)o.push(Object.assign({},r,s[d]));var c,p,m,f=function(e,t){document.getElementById("filter-field").value;e.push("fichiers fusionnés"),e.push("Grade_TC");var n=h.csvParse(l.a.unparse(t)),a={};e.forEach((e,t)=>{a[e]=""});for(var i=[],o=h.nest().key(e=>e["Student ID"]).rollup(t=>{var n=t.map(e=>[].concat.call([],Object.values(e)));return n.unshift(e),{arr:n}}).entries(n),s=0,r=o.length;s<r;s++){var d=o[s],u=d.value.arr,c={};e.forEach((e,t)=>{"Grade"===e||"Enrollment Track"===e||"Enrollment Status"===e||"fichiers fusionnés"===e||"Grade_TC"===e?(c[e]=g(u.slice(1,u.length),t),void 0!==c["fichiers fusionnés"]&&c["fichiers fusionnés"].length>0&&"TC"===c["fichiers fusionnés"][0]?c.Grade_TC=c.Grade[0]:c.Grade_TC=""):c[e]=[...new Set(g(u.slice(1,u.length),t))]}),i.push(Object.assign({},a,c))}return h.csvParseRows(l.a.unparse(i))}(n,o).sort((e,t)=>e[0]-t[0]);p=(c=f)[0].map(e=>e.trim()),m=[],c.forEach((e,t)=>{0===t||void 0===e[0]||""===e[0]||e[0].match(/^(\r\n|\r|\n)$/)||(e[0]=e[0].trim(),m.push(e))}),m.unshift(p),f=m;var v=function(t){var n=l.a.parse(t).meta.delimiter,i=h.dsvFormat(n).parseRows(t,function(e){if(e&&void 0!==e&&0!==e[0].length)return e}).sort((e,t)=>e[0]-t[0]),o=h.csvParse(l.a.unparse(i));void 0!==i&&function(t){var n=!0;t[0].slice(0,4).forEach(e=>{-1===F.indexOf(e)&&(n=!1)}),n||swal({title:"Fichier profile_info",text:"Un des champs en entête des 4 premières colonnes ne correspond pas au champs attendus dans l'ordre suivant:\n[id] [username] [name] [email]",icon:"warning"}).then(t=>{document.getElementById("profil_info-div").firstElementChild.classList.replace("normal","labelProfile"),e(".fa-arrow-alt-circle-right").addClass("blink"),document.getElementById("spinnerLoad-span").classList.replace("inline","hidden"),document.getElementById("fileInputMappage").disabled=!1});return n}(i)&&a({flat:f,dataMappage:o})};document.getElementById("fileInputMappage").onchange=function(e){this.disabled=!0,document.getElementById("profil_info-div").classList.replace("inline","hidden"),document.getElementById("spinnerLoad-span").classList.replace("hidden","inline");var t=this.files[0],n=new FileReader;n.onprogress=function(e){},n.onloadend=function(e){},n.onload=function(e){v(n.result)},n.readAsText(t)}})}(t,n).then(function(t){var n=h.csvParse(l.a.unparse(t.flat)),a=t.dataMappage,i=n.map(function(e,t){var n;e.Username&&void 0!==e.Username&&(n=isNaN(e.Username)?e.Username:e.Username.toString());var i=a.find(e=>e.username===n),l=a.find(t=>t.email===e.Email);e.Name=void 0===i||void 0===l?"":i.name;var o=a.find(t=>t.id===e["Student ID"]);return void 0===o?e.Name="Absent sur profile_info":(e.Name=o.name,e.year_of_birth=o.year_of_birth?o.year_of_birth:""),function(e,t){return t.reduce((n,a)=>{t.indexOf(a);return n[a]=e[a],n},{})}(e,v)});!function(t,n){var a=h.csvParseRows(l.a.unparse(t)),i=a.map(e=>A(e)),o=e("#selectCohortes-btn");o.find("option").remove();for(var s=0,r=b.length;s<r;s++)o.append('<option value="'+b[s]+'">'+b[s]+"</option>");var d=[...new Set(i.map(e=>e[5]))],p=d[0];d=d.slice(1,d.length);var f=document.getElementById("cohortes-btn");f.innerHTML=d.length+' cohortes <i class="fas fa-download"></i>';var g=[i[0].slice(17,32)],F=i.slice(1,i.length).map(e=>e.slice(17,32).map(e=>isNaN(parseFloat(e))?0:parseFloat(e)));i[0].splice(6,0,"Attestation PC"),i[0].splice(7,0,"Attestation PA"),i[0].splice(8,0,"Grade TC"),i[0].splice(10,0,"1ère SPE"),i[0].splice(11,0,"2ème SPE"),i[0].splice(12,0,"SPE validées");for(var v,y,E=0,x=[],s=0,r=i.slice(1,i.length).length;s<r;s++){var C=(v=i.slice(1,i.length)[s])[5],I=v[16],w=(null!=v[32]&&v[32].split(","),null!=v[33]?v[33].split(","):""),N=null!=v[39]?v[39].split(","):"",D=v[40],_={};w.forEach((e,t)=>{_[N[t]]=e}),"Absent sur profile_info"===v[3]&&E++,v[39]&&-1!==v[39].split(",").indexOf("TC")&&"TC"!==v[39].split(",")[0]?x.push([v[0],v[39]]):v[39]&&-1!==v[39].split(",").indexOf("PA")&&"PA"!==v[39].split(",")[v[39].split(",").length-1]&&x.push([v[0],v[39]]),y=F[s].filter(e=>e>=.695).length;var j=Math.max.apply(null,F[s]),G=j>=.695&&-1!==F[s].indexOf(j)?g[0][F[s].indexOf(j)]:"";F[s].length>1&&-1!==F[s].indexOf(j)&&F[s].splice(F[s].indexOf(j),1,0);var H=Math.max.apply(null,F[s]),V=H>=.695&&-1!==F[s].indexOf(H)?g[0][F[s].indexOf(H)]:"";V===G&&(V=""),G=P.test(G)?G.match(P)[0].replace(/\s\-/,""):G,V=P.test(V)?V.match(P)[0].replace(/\s\-/,""):V;var U,z,Z=Object.entries(_).filter(e=>"TC"!==e[0]&&"PA"!==e[0]&&"verified"===e[1]).map(e=>e[0]),J=Z.length>=2,$=Z.length<2,K=""!=D&&+D>=.695&&y>=2,Q=""!=D&&+D>=.695&&y>=2&&I>=.695,W=_.TC&&"verified"===_.TC,X=_.TC&&"verified"!==_.TC,Y=_.PA&&"verified"===_.PA,ee=_.PA&&"verified"!==_.PA;U=""!==C&&K?"OUI":K&&W&&J?"OUI":K&&W&&$?"en attente":K&&X&&J?"en attente":"NON",z=""!==C&&Q?"OUI":Q&&Y&&"OUI"===U?"OUI":Q&&Y&&"en attente"===U?"en attente":Q&&ee&&"OUI"===U||"en attente"===U?"en attente":"NON",v.splice(6,0,U),v.splice(7,0,z),v.splice(8,0,D),v.splice(10,0,G),v.splice(11,0,V),v.splice(12,0,y),v.splice(46,1)}i[0].splice(46,1),x.length>0&&(document.getElementById("checkFiles-btn").classList.replace("hidden","inline"),document.getElementById("checkFiles-btn").classList.add("blink"));document.getElementById("checkFiles-btn").onclick=function(){x.unshift([i[0][0],i[0][40]]),M(x,"erreur-fusion-fichiers")},document.getElementById("finalStandard-btn").onclick=function(t){document.getElementById("tableApp-div").classList.add("hidden"),document.getElementById("tableFinal-div").classList.remove("hidden"),"done"!==this.dataset.switch&&(document.getElementById("spinnerLoadFinal-span").classList.replace("hidden","inline"),setTimeout(()=>{!function(t,n){var a=/^\d{1,3}\%/g,i=function(e,t){for(var n,a,i,o=[e[0].slice(17,32)],s=e.slice(1,e.length).sort(function(e,t){return e[0]-t[0]}),r=/^[0-9]+([.][0-9]+)?%?$/,d=([].concat.apply([],s.map(function(e){return e.filter(function(e){return r.test(e)&&(e=>e-Math.floor(e)!=0)(e.valueOf())&&Number.isInteger(parseInt(e))})})),s.map(e=>e.slice(17,32).map(e=>isNaN(parseFloat(e))?0:parseFloat(e)))),u=s.map(e=>e.slice(7,11).map(e=>isNaN(parseFloat(e))?0:parseFloat(e))),c=s.map(e=>e.slice(12,13).map(e=>isNaN(parseFloat(e))?0:parseFloat(e))),p=s.map(e=>e.slice(13,16).map(e=>isNaN(parseFloat(e))?0:parseFloat(e))),m=0,f=s.length;m<f;m++){n=s[m][3],a=s[m][5],i=d[m].filter(e=>e>=.7).length;var g=Math.max.apply(null,d[m]),F=g>=.7&&-1!==d[m].indexOf(g)?o[0][d[m].indexOf(g)]:"";d[m].length>1&&-1!==d[m].indexOf(g)&&d[m].splice(d[m].indexOf(g),1,0);var v=Math.max.apply(null,d[m]),b=v>=.7&&-1!==d[m].indexOf(v)?o[0][d[m].indexOf(v)]:"";b===F&&(b=""),F=P.test(F)?F.match(P)[0].replace(/\s\-/,""):F,b=P.test(b)?b.match(P)[0].replace(/\s\-/,""):b;var y=t.find(e=>e.id===s[m][0]);y=y&&void 0!==y?y.email:"",s[m].splice(2,1,n),s[m].splice(3,1,y),s[m].splice(4,1,a),h.sum(u[m])/4>=.7&&c[m][0]>=.7&&i>=2?s[m].splice(5,1,"OUI"):s[m].splice(5,1,"NON"),(h.sum(u[m])+h.sum(p[m]))/7>=.7&&c[m][0]>=.7&&i>=2?s[m].splice(6,1,"OUI"):s[m].splice(6,1,"NON"),isNaN(parseFloat(s[m][7]))?s[m].push(""):s[m].push(T(parseFloat(100*s[m][7]).toFixed(2))+"%"),isNaN(parseFloat(s[m][7]))?s[m].push(""):s[m].push(T(parseFloat(100*s[m][7]/5).toFixed(2))),isNaN(parseFloat(s[m][8]))?s[m].push(""):s[m].push(T(parseFloat(100*s[m][8]).toFixed(2))+"%"),isNaN(parseFloat(s[m][8]))?s[m].push(""):s[m].push(T(parseFloat(100*s[m][8]/5).toFixed(2))),isNaN(parseFloat(s[m][9]))?s[m].push(""):s[m].push(T(parseFloat(100*s[m][9]).toFixed(2))+"%"),isNaN(parseFloat(s[m][9]))?s[m].push(""):s[m].push(T(parseFloat(100*s[m][9]/5).toFixed(2))),isNaN(parseFloat(s[m][10]))?s[m].push(""):s[m].push(T(parseFloat(100*s[m][10]).toFixed(2))+"%"),isNaN(parseFloat(s[m][10]))?s[m].push(""):s[m].push(T(parseFloat(100*s[m][10]/5).toFixed(2))),isNaN(parseFloat(s[m][12]))?s[m].push(""):s[m].push(T(parseFloat(100*s[m][12]).toFixed(2))+"%"),isNaN(parseFloat(s[m][12]))?s[m].push(""):s[m].push(T(parseFloat(100*s[m][12]/5).toFixed(2))),isNaN(parseFloat(s[m][13]))?s[m].push(""):s[m].push(T(parseFloat(100*s[m][13]).toFixed(2))+"%"),isNaN(parseFloat(s[m][13]))?s[m].push(""):s[m].push(T(parseFloat(100*s[m][13]/5).toFixed(2))),isNaN(parseFloat(s[m][14]))?s[m].push(""):s[m].push(T(parseFloat(100*s[m][14]).toFixed(2))+"%"),isNaN(parseFloat(s[m][14]))?s[m].push(""):s[m].push(T(parseFloat(100*s[m][14]/5).toFixed(2))),isNaN(parseFloat(s[m][15]))?s[m].push(""):s[m].push(T(parseFloat(100*s[m][15]).toFixed(2))+"%"),isNaN(parseFloat(s[m][15]))?s[m].push(""):s[m].push(T(parseFloat(100*s[m][15]/5).toFixed(2))),isNaN(parseFloat(s[m][17]))?s[m].push(""):s[m].push(T(parseFloat(100*s[m][17]).toFixed(2))+"%"),isNaN(parseFloat(s[m][17]))?s[m].push(""):s[m].push(T(parseFloat(100*s[m][17]/5).toFixed(2))),isNaN(parseFloat(s[m][18]))?s[m].push(""):s[m].push(T(parseFloat(100*s[m][18]).toFixed(2))+"%"),isNaN(parseFloat(s[m][18]))?s[m].push(""):s[m].push(T(parseFloat(100*s[m][18]/5).toFixed(2))),isNaN(parseFloat(s[m][19]))?s[m].push(""):s[m].push(T(parseFloat(100*s[m][19]).toFixed(2))+"%"),isNaN(parseFloat(s[m][19]))?s[m].push(""):s[m].push(T(parseFloat(100*s[m][19]/5).toFixed(2))),isNaN(parseFloat(s[m][20]))?s[m].push(""):s[m].push(T(parseFloat(100*s[m][20]).toFixed(2))+"%"),isNaN(parseFloat(s[m][20]))?s[m].push(""):s[m].push(T(parseFloat(100*s[m][20]/5).toFixed(2))),isNaN(parseFloat(s[m][21]))?s[m].push(""):s[m].push(T(parseFloat(100*s[m][21]).toFixed(2))+"%"),isNaN(parseFloat(s[m][21]))?s[m].push(""):s[m].push(T(parseFloat(100*s[m][21]/5).toFixed(2))),isNaN(parseFloat(s[m][22]))?s[m].push(""):s[m].push(T(parseFloat(100*s[m][22]).toFixed(2))+"%"),isNaN(parseFloat(s[m][22]))?s[m].push(""):s[m].push(T(parseFloat(100*s[m][22]/5).toFixed(2))),isNaN(parseFloat(s[m][23]))?s[m].push(""):s[m].push(T(parseFloat(100*s[m][23]).toFixed(2))+"%"),isNaN(parseFloat(s[m][23]))?s[m].push(""):s[m].push(T(parseFloat(100*s[m][23]/5).toFixed(2))),isNaN(parseFloat(s[m][24]))?s[m].push(""):s[m].push(T(parseFloat(100*s[m][24]).toFixed(2))+"%"),isNaN(parseFloat(s[m][24]))?s[m].push(""):s[m].push(T(parseFloat(100*s[m][24]/5).toFixed(2))),isNaN(parseFloat(s[m][25]))?s[m].push(""):s[m].push(T(parseFloat(100*s[m][25]).toFixed(2))+"%"),isNaN(parseFloat(s[m][25]))?s[m].push(""):s[m].push(T(parseFloat(100*s[m][25]/5).toFixed(2))),isNaN(parseFloat(s[m][26]))?s[m].push(""):s[m].push(T(parseFloat(100*s[m][26]).toFixed(2))+"%"),isNaN(parseFloat(s[m][26]))?s[m].push(""):s[m].push(T(parseFloat(100*s[m][26]/5).toFixed(2))),isNaN(parseFloat(s[m][27]))?s[m].push(""):s[m].push(T(parseFloat(100*s[m][27]).toFixed(2))+"%"),isNaN(parseFloat(s[m][27]))?s[m].push(""):s[m].push(T(parseFloat(100*s[m][27]/5).toFixed(2))),isNaN(parseFloat(s[m][28]))?s[m].push(""):s[m].push(T(parseFloat(100*s[m][28]).toFixed(2))+"%"),isNaN(parseFloat(s[m][28]))?s[m].push(""):s[m].push(T(parseFloat(100*s[m][28]/5).toFixed(2))),isNaN(parseFloat(s[m][29]))?s[m].push(""):s[m].push(T(parseFloat(100*s[m][29]).toFixed(2))+"%"),isNaN(parseFloat(s[m][29]))?s[m].push(""):s[m].push(T(parseFloat(100*s[m][29]/5).toFixed(2))),isNaN(parseFloat(s[m][30]))?s[m].push(""):s[m].push(T(parseFloat(100*s[m][30]).toFixed(2))+"%"),isNaN(parseFloat(s[m][30]))?s[m].push(""):s[m].push(T(parseFloat(100*s[m][30]/5).toFixed(2))),isNaN(parseFloat(s[m][31]))?s[m].push(""):s[m].push(T(parseFloat(100*s[m][31]).toFixed(2))+"%"),isNaN(parseFloat(s[m][31]))?s[m].push(""):s[m].push(T(parseFloat(100*s[m][31]/5).toFixed(2))),s[m].splice(7,34),i?s[m].push(i.toFixed(0)):s[m].push(""),s[m].push(F),s[m].push(b),i&&i>=2?s[m].push(""):s[m].push("< 2"),h.sum(u[m])/4>=.7?s[m].push(""):s[m].push("< 70%"),c[m][0]>=.7?s[m].push(""):s[m].push("< 70%"),(h.sum(u[m])+h.sum(p[m]))/7>=.7?s[m].push(""):s[m].push("< 70%"),3===p[m].filter(e=>0!==e).length?s[m].push(""):s[m].push("< 3")}var E=e.slice(0);return E.splice(0,1),E.map(e=>A(e)),E.unshift(["Student ID","Email","Étudiant","Mail d'inscription","Cohorte","Classique","Avancé","S1 (%)","S1 (/20)","S2 (%)","S2 (/20)","S3 (%)","S3 (/20)","S4 (%)","S4 (/20)","Examen Final (%)"," Examen Final (/20)","Devoir 1 (%)","Devoir 1 (/20)","Devoir 2 (%)","Devoir 2 (/20)","Devoir 3 (%)","Devoir 3 (/20)","Diagnostic de Fonctionnement Système\n01 - DFS (%)","Diagnostic de Fonctionnement Système\n01 - DFS (/20)","Management Créativité & Brainstorming\n02 - MCB (%)","Management Créativité & Brainstorming\n02 - MCB (/20)","Management d'Équipe-Projet\n03 - MEP (%)","Management d'Équipe-Projet\n03 - MEP (/20)","Outils Informatiques & Évaluation Financière\n04 - IEF (%)","Outils Informatiques & Évaluation Financière\n04 - IEF (/20)","Certification professionnelle PMI®\n05 - PMI (%)","Certification professionnelle PMI®\n05 - PMI (/20)","Analyse Fonctionnelle\n06 - AF (%)","Analyse Fonctionnelle\n06 - AF (/20)","Analyse Stratégique\n07 - AS (%)","Analyse Stratégique\n07 - AS (/20)","Évaluation d'Impact des Projets\n08 - EIP (%)","Évaluation d'Impact des Projets\n08 - EIP (/20)","Planification Avancée\n09 - PAV (%)","Planification Avancée\n09 - PAV (/20)","Management Visuel de Projet\n10 - MVP (%)","Management Visuel de Projet\n10 - MVP (/20)","Gestion de Projet Agile avec Scrum\n11 - GPAS (%)","Gestion de Projet Agile avec Scrum\n11 - GPAS (/20)","Méthode de Résolution de Problèmes\n12 - MRP (%)","Méthode de Résolution de Problèmes\n12 - MRP (/20)","Résolution Créative de Problèmes : TRIZ\n13 - TRIZ (%)","Résolution Créative de Problèmes : TRIZ\n13 - TRIZ (/20)","Gestion De Crise\n14 - G2C (%)","Gestion De Crise\n14 - G2C (/20)","Action Entrepreneuriale\n15 - PAE (%)","Action Entrepreneuriale\n15 - PAE (/20)","Nombre\nmodules réussis","Meilleur\nmodule réussi 1","Meilleur\nmodule réussi 2","Causes Échec\n(PC & PA) Modules","Causes Échec\n(PC ) Moyenne Quiz","Causes Échec\n(PC & PA) Examen final","Causes Échec\n(PA) Moyenne Quiz & Devoirs","Causes Échec\n(PA) Devoirs"]),h.csvParse(l.a.unparse(E))}(t,n),o=0;i.forEach(e=>{"Absent sur profile_info"===e["Étudiant"]&&o++});var s=i.columns,r=s.filter((e,t)=>t>=0&&t<=4),d=s.filter((e,t)=>t>=5&&t<7),c=s.filter((e,t)=>t>=7&&t<15),p=s.filter((e,t)=>t>=15&&t<17),m=s.filter((e,t)=>t>=17&&t<23),f=s.filter((e,t)=>t>=23&&t<53),g=s.filter((e,t)=>t>=53&&t<56),F=s.filter((e,t)=>t>=56&&t<=60),v=[{title:"Informations participants",columns:r},{title:"Attestation",columns:d},{title:"Parcours Classique (PC)",columns:c},{title:"Examen Final",columns:p},{title:"Parcours Avancé (PA)",columns:m},{title:"Modules de Spécialisation",columns:f},{title:"Modules réussis",columns:g},{title:"Causes Échec",columns:F}],b=["Informations participants","Attestation","Parcours Classique (PC)","Examen Final","Parcours Avancé (PA)","Modules de Spécialisation","Modules réussis","Causes Échec"],y=e("#groupsColumns-btn");y.find("option").remove();for(var E=0,x=b.length;E<x;E++)y.append('<option value="'+b[E]+'">'+b[E]+"</option>");var C={"Informations participants":r,Attestation:d,"Parcours Classique (PC)":c,"Examen Final":p,"Parcours Avancé (PA)":m,"Modules de Spécialisation":f,"Modules réussis":g,"Causes Échec":F},I=function(t){var n=[];return t.forEach((t,a)=>{var l,o,s=[];0===a?t.columns.forEach((e,t)=>{n.push({id:a,title:e,field:e,frozen:!0,visible:"Étudiant"===e||"Cohorte"===e,headerFilter:"input",headerFilterPlaceholder:"...",cellContext:0===t&&function(e,t){var n=Object.entries(t.getRow().getData());O(["entête","valeur"],n,"pvtTable"),e.preventDefault()}})}):1===a?n.push({title:t.title,columns:[{title:"<span style='color:red'>TC + 2 modules</span>",columns:[{id:0,title:t.columns[0],field:t.columns[0],headerFilter:"input",headerFilterPlaceholder:"..."}]},{title:"<span style='color:red'>Classique + 3 devoirs</span>",columns:[{id:1,title:t.columns[1],field:t.columns[1],headerFilter:"input",headerFilterPlaceholder:"..."}]}]}):2===a?(t.columns.forEach(e=>{s.push({id:a,title:e,field:e,visible:!1,headerFilter:"input",headerFilterPlaceholder:"number"===o?"< <= = >= >":"...",headerFilterFunc:"number"===o&&S})}),n.push({title:t.title,columns:[{title:"<span style='color:red'>70 % minimum</span>",columns:s}]})):3===a?(t.columns.forEach(e=>{s.push({id:a,title:e,field:e,headerFilter:"input",headerFilterPlaceholder:"number"===o?"< <= = >= >":"...",headerFilterFunc:"number"===o&&S})}),n.push({title:t.title,columns:[{title:"<span style='color:red'>70 % minimum</span>",columns:s}]})):4===a?(t.columns.forEach(e=>{s.push({id:a,title:e,field:e,visible:!1,headerFilter:"input",headerFilterPlaceholder:"number"===o?"< <= = >= >":"...",headerFilterFunc:"number"===o&&S})}),n.push({title:t.title,columns:[{title:"<span style='color:red'>70 % minimum</span>",columns:s}]})):5===a?(t.columns.forEach(e=>{s.push({id:a,title:e,field:e,visible:!1,headerFilter:"input",headerFilterPlaceholder:"number"===o?"< <= = >= >":"...",headerFilterFunc:"number"===o&&S})}),n.push({title:t.title,columns:[{title:"<span style='color:red'>70 % min par module avec 2 modules minimum réussis</span>",columns:s}]})):6===a?(t.columns.forEach(e=>{s.push({id:a,title:e,field:e,headerFilter:"input",headerFilterPlaceholder:"number"===o?"< <= = >= >":"...",headerFilterFunc:"number"===o&&S})}),n.push({title:t.title,columns:[{title:"<span style='color:red'>2 modules minimum</span>",columns:s}]})):7===a?(t.columns.forEach((e,t)=>{t>0&&t<4&&s.push({id:a,title:e,field:e,headerFilter:"input",headerFilterPlaceholder:"..."})}),n.push({title:t.title,columns:[{title:"<span style='color:red'>Nombre < 2</span>",columns:[{id:0,title:t.columns[0],field:t.columns[0],headerFilter:"input",headerFilterPlaceholder:"..."}]},{title:"<span style='color:red'>Score < à 70 %</span>",columns:s},{title:"<span style='color:red'>Nombre < 3</span>",columns:[{id:4,title:t.columns[4],field:t.columns[4],headerFilter:"input",headerFilterPlaceholder:"..."}]}]})):(t.columns.forEach(t=>{l=function(t,n){for(var a,i=[],l=1,o=t.length;l<o;l++)a=e.isNumeric(t[l][n])?t[l][n]:0,i.push(a);return k(i)}(i,t),o=l.length>0?"number":"string",s.push({id:a,title:t,field:t,headerFilter:"input",headerFilterPlaceholder:"number"===o?"< <= = >= >":"...",headerFilterFunc:"number"===o&&S})}),n.push({title:t.title,columns:s}))}),n}(v),w='<div class="footerInfo"> ';w+='<a type="button" href="https://github.com/olifolkerd/tabulator" target="_blank" style="margin-right: 3em; padding: 2px 5px; font-weight: 900">Tabulator</a>',w+='lignes: <span id="rowsTotal-final" style="font-weight: 900">'+i.length+"</span>",w+='<span style="margin-left: 1em">colonnes: </span><span id="columnsTotal" style="font-weight: 900">'+s.length+"</span>",w+='<div style="margin-left: 4em;" class="inline">',w+='<span>lignes: </span><span id="rowsCount-final" style="font-weight: 900"></span> (filtrée.s)',w+='<span style="margin-left: 2em">sélection: </span><span id="rowSelected-final" style="font-weight: 900"></span> (ligne.s)',w+='<span style="margin-left: 2em">total absence.s: </span><span style="font-weight: 900; color:red">'+o+"</span>",w+="</div></div>";var N=new u("#table-final",{clipboard:!0,selectable:!0,height:Math.round(window.innerHeight)-55,virtualDomBuffer:1e5,data:i,reactiveData:!0,tooltipsHeader:!0,columns:I,pagination:"local",paginationSize:100,movableColumns:!0,history:!0,tooltips:!0,placeholder:"Aucune donnée disponible",footerElement:w,groupToggleElement:"header",rowFormatter:function(e){e.getData().Email!==e.getData()["Mail d'inscription"]&&(e.getCells()[1].getElement().style.backgroundColor="#FFABAD",e.getCells()[2].getElement().style.backgroundColor="#FFABAD",e.getCells()[3].getElement().style.backgroundColor="#FFABAD")},rowSelectionChanged:function(e,t){document.getElementById("rowSelected-final").innerHTML=e.length},dataFiltered:function(e,t){document.getElementById("rowsCount-final").innerHTML=t.length},groupStartOpen:function(e,t,n,a){return!1},groupHeader:function(e,t,n,a){return e+"<span style='color:#d00; margin-left:10px;' title='Clic droit pour export CSV'>("+t+" item)</span>"},groupContext:function(e,t){e.preventDefault();var n=t.getSubGroups(),i=t.getElement(),o=[];if(0===n.length){t.getRows().forEach(e=>{o.push(e.getData())});var s=t.getKey(),r=(o=h.csvParseRows(l.a.unparse(o)))[0];(o=o.slice(1,o.length).map(e=>e.map(e=>(e=>a.test(e)?e:isNaN(parseFloat(e))||a.test(e)?e:parseFloat(e).toLocaleString("fr-FR"))(e)))).unshift(r),M(o,"Cohorte_"+s)}else i.classList.add("shaker"),setTimeout(()=>{i.classList.remove("shaker")},400)}});N.setGroupBy("Cohorte"),document.getElementById("groupExpandCollapse-btn").onclick=function(){document.getElementById("spinnerLoadFinal-span").classList.remove("hidden"),setTimeout(()=>{"collapse"===this.dataset.state?(N.getGroups().forEach(e=>{e.show()}),this.dataset.state="expand",this.innerHTML='<i class="fas fa-minus"></i>',document.getElementById("spinnerLoadFinal-span").classList.add("hidden")):(N.getGroups().forEach(e=>{e.hide()}),this.dataset.state="collapse",this.innerHTML='<i class="fas fa-plus"></i>',document.getElementById("spinnerLoadFinal-span").classList.add("hidden"))},100)},document.getElementById("tableReport-btn").onclick=function(){document.getElementById("tableFinal-div").classList.add("hidden"),document.getElementById("tableApp-div").classList.remove("hidden")},document.getElementById("deselectAllRows-final").onclick=function(e){N.deselectRow()},document.getElementById("filtersHeaderClear-final").onclick=function(e){N.clearHeaderFilter()},document.getElementById("tableReport-btn").onclick=function(e){document.getElementById("tableFinal-div").classList.add("hidden"),document.getElementById("tableApp-div").classList.remove("hidden")},document.getElementById("hideGroup-btn").onclick=function(){document.getElementById("spinnerLoadFinal-span").classList.remove("hidden");var e=document.getElementById("groupsColumns-btn"),t=e.options[e.selectedIndex].value,n=C[t];setTimeout(()=>{for(var e=0,t=n.length;e<t;++e)N.hideColumn(n[e]);document.getElementById("spinnerLoadFinal-span").classList.add("hidden")})},document.getElementById("showGroup-btn").onclick=function(){document.getElementById("spinnerLoadFinal-span").classList.remove("hidden");var e=document.getElementById("groupsColumns-btn"),t=e.options[e.selectedIndex].value,n=C[t];setTimeout(()=>{for(var e=0,t=n.length;e<t;++e)N.showColumn(n[e]);document.getElementById("spinnerLoadFinal-span").classList.add("hidden")})},document.getElementById("hideCol-final").onclick=function(){var e=[];N.getColumns().forEach(t=>{t.getVisibility()&&e.push(t.getField())}),q(["","colonnes"],e,"pvtTable",N,"hide"),e=null},document.getElementById("showCol-final").onclick=function(){var e=[];N.getColumns().forEach(t=>{t.getVisibility()||e.push(t.getField())}),q(["","colonnes"],e,"pvtTable",N,"show"),e=null},document.getElementById("exportFinalComma-btn").onclick=function(e){document.getElementById("spinnerLoadFinal-span").classList.replace("hidden","inline"),setTimeout(()=>{var e=function(){var e=N.getData(!0),t=N.getSelectedData(),n=(e.filter(e=>-1!==t.indexOf(e)),[]);N.getColumns().forEach(e=>{e.getVisibility()&&n.push(e.getField())});var a=e.map(e=>Object.keys(e).filter(e=>n.includes(e)).reduce((t,n)=>(t[n]=e[n],t),{}));return h.csvParseRows(l.a.unparse(a))}();e.slice(1,e.length).forEach(e=>{for(var t=0,n=e.length;t<n;t++)-1===e[t].indexOf(".")||isNaN(parseFloat(e[t]))||(e[t]=parseFloat(e[t]).toLocaleString("fr-FR"))}),M(e,"final-standard"),document.getElementById("spinnerLoadFinal-span").classList.replace("inline","hidden")},100)},document.getElementById("finalStandard-btn").dataset.switch="done",document.getElementById("spinnerLoadFinal-span").classList.add("hidden"),console.log("finalTable done !")}(a.filter(e=>""!==e[5]),n)},1e3))},f.onclick=function(e){var t=document.getElementById("selectCohortes-btn").value,n=function(e,t,n){var a=h.nest().key(e=>e[n]).rollup(e=>{var n=k(e.map(e=>isNaN(parseFloat(e[t]))?0:Math.round(100*parseFloat(e[t]))/100).sort()),a=e.length,i=e.filter(e=>""!==e["Grade TC"]).length,l=n.length>=1?parseFloat(h.median(n)):0,o=n.length>=1?parseFloat(h.min(n)):0,s=n.length>=1?parseFloat(h.max(n)):0,r=n.length>=1?parseFloat(h.mean(n)):0,d=n.length>1?parseFloat(h.quantile(n,.25)):0,u=n.length>1?parseFloat(h.quantile(n,.75)):0,c=n.length>1?parseFloat(h.quantile(n,.1)):0,p=n.length>1?parseFloat(h.quantile(n,.9)):0,m=0!==c&&0!==p?p/c:0,f=n.length>1?parseFloat(h.variance(n)):0,g=n.length>1?parseFloat(h.deviation(n)):0;return{participants:a,actifs:i,min:0!==o?o.toFixed(2):"",max:0!==s?s.toFixed(2):"",avg:0!==r?r.toFixed(2):"",median:0!==l?l.toFixed(2):"",quartileFirst:0!==d?d.toFixed(2):"",quartileThird:0!==u?u.toFixed(2):"",decileFirst:0!==c?c.toFixed(2):"",decileLast:0!==p?p.toFixed(2):"",rapportD9D1:0!==m?m.toFixed(2):"",variance:0!==f?f.toFixed(2):"",deviation:0!==g?g.toFixed(2):""}}).entries(e);console.log(a);var i=[["cohorte","participants","actifs","min","max","moyenne","médiane","1er quartile","3ème quartile","1er décile","9ème décile","rapport (d9/d1)","variance","écart-type"]];return a.forEach(e=>{var t=e.key?e.key:"hors cohortes",n=e.value;i.push([t,n.participants,n.actifs,n.min,n.max,n.avg,n.median,n.quartileFirst,n.quartileThird,n.decileFirst,n.decileLast,n.rapportD9D1,n.variance,n.deviation])}),i}(h.csvParse(l.a.unparse(i)),t,p);setTimeout(()=>{R("cohortes (détails)",n,this,t)},100)},function(t,n){var a=t.length>1e3?t.slice(0,1e3):t.slice(0,t.length),i=t.slice(0,t.length).length-a.length,o=t.columns;!function(t){t.forEach(t=>{e("#filter-field").append('<option value="'+t+'" style="max-width:100px;">'+L(t)+"</option>")}),["like","=","<","<=",">",">=","!="].forEach(t=>{e("#filter-type").append('<option value="'+t+'" style="max-width:100px;">'+t+"</option>")})}(o);var s=function(e){var t,n=[];return e.forEach((a,i)=>{t=L(a),a===e[0]?n.push({id:i,title:t,field:a,frozen:!0,headerFilter:"input",headerFilterPlaceholder:"...",cellContext:function(e,t){O(["entête","valeur"],Object.entries(t.getRow().getData()),"pvtTable"),e.preventDefault()},headerContext:function(e,t){e.preventDefault(),B(t.getField())}}):a===e[1]?n.push({id:i,title:t,field:a,frozen:!0,width:150,headerFilter:"input",headerFilterPlaceholder:"...",headerContext:function(e,t){e.preventDefault(),B(t.getField())}}):a===e[2]?n.push({id:i,title:t,field:a,visible:!1,headerFilter:"input",headerFilterPlaceholder:"...",headerContext:function(e,t){e.preventDefault(),B(t.getField())}}):a===e[3]||a===e[4]?n.push({id:i,title:t,field:a,width:150,headerFilter:"input",headerFilterPlaceholder:"...",headerContext:function(e,t){e.preventDefault(),B(t.getField())}}):9===i?n.push({id:i,title:t,field:a,formatter:"numberfmt",headerFilter:"input",headerFilterPlaceholder:"...",headerContext:function(e,t){e.preventDefault(),B(t.getField())}}):i>12&&i<18?n.push({id:i,title:t,field:a,visible:!1,formatter:"numberfmt",headerFilter:"number",headerFilterPlaceholder:">=",headerFilterFunc:">=",headerFilterParams:{min:0,max:1,step:.01},headerContext:function(e,t){e.preventDefault(),B(t.getField())}}):12===i?n.push({id:i,title:t,field:a,headerFilter:"input",headerFilterPlaceholder:"< <= = >= >",headerFilterFunc:S,headerContext:function(e,t){e.preventDefault(),B(t.getField())}}):8===i||18===i?n.push({id:i,title:t,field:a,formatter:"numberfmt",headerFilter:"input",headerFilterPlaceholder:"< <= = >= >",headerFilterFunc:S,headerContext:function(e,t){e.preventDefault(),B(t.getField())}}):i>18&&i<=38?n.push({id:i,title:t,field:a,formatter:"numberfmt",visible:!1,headerFilter:"number",headerFilterPlaceholder:">=",headerFilterFunc:">=",headerFilterParams:{min:0,max:1,step:.01},headerContext:function(e,t){e.preventDefault(),B(t.getField())}}):i>38&&i<45?n.push({id:i,title:t,field:a,visible:!1,headerFilter:"input",headerFilterPlaceholder:"...",headerContext:function(e,t){e.preventDefault(),B(t.getField())}}):i===e.length-1?n.push({id:i,title:t,field:a,headerFilter:"input",headerFilterPlaceholder:"...",formatter:"checkfiles",headerContext:function(e,t){e.preventDefault(),B(t.getField())}}):n.push({id:i,title:t,field:a,headerFilter:"input",headerFilterPlaceholder:"...",headerContext:function(e,t){e.preventDefault(),B(t.getField())}})}),n}(o),r=new u("#table-app",function(e,t){var n='<div class="footerInfo"> ';return n+='<a type="button" href="https://github.com/olifolkerd/tabulator" target="_blank" style="margin-right: 3em; padding: 2px 5px; font-weight: 900">Tabulator</a>',n+='lignes: <span id="rowsTotal" style="font-weight: 900">'+e.length+"</span>",n+='<span style="margin-left: 1em">colonnes: </span><span id="columnsTotal" style="font-weight: 900">'+t.length+"</span>",n+='<div style="margin-left: 4em;" class="inline">',n+='<span>lignes: </span><span id="rowsCount" style="font-weight: 900"></span> (filtrée.s)',n+='<span style="margin-left: 2em">sélection: </span><span id="rowSelected" style="font-weight: 900"></span> (ligne.s)',n+='<span style="margin-left: 2em">total absence.s: </span><span id="absences" style="font-weight: 900; color:red"></span>',n+='</div><div style="margin-left: 4em;" class="inline">',n+='<span style="margin-left: 2em">groupe.s: </span><span id="groupsNumber" style="font-weight: 900"></span>',n+="</div></div>",{selectable:!0,height:Math.round(window.innerHeight)-50,data:e,reactiveData:!0,tooltipsHeader:!0,columns:t,pagination:"local",paginationSize:100,movableColumns:!0,footerElement:n,history:!0,tooltips:!0,placeholder:"Aucune donnée disponible",groupToggleElement:"header",initialSort:[{column:"Student ID",dir:"asc"}],rowClick:function(e,t){},rowSelectionChanged:function(e,t){document.getElementById("rowSelected").innerHTML=e.length},dataFiltered:function(e,t){document.getElementById("rowsCount").innerHTML=t.length},groupStartOpen:function(e,t,n,a){return!1},groupHeader:function(e,t,n,a){var i=document.getElementById("groupBy-input").value;return 0===a.getSubGroups().length?"<span style='color:#0000FFFF; margin-right: 5px;' title='clic droit pour export'>"+i+"</span> : "+e+"<span style='color:#d00; margin-left:10px;'>("+t+" item)</span>":"<span style='color:#0000FFFF; margin-right: 5px;'>"+i+"</span> : "+e+"<span style='color:#d00; margin-left:10px;'>("+t+" item)</span>"},groupContext:function(e,t){e.preventDefault();var n=document.getElementById("groupBy-input").value.split(">").map(e=>e.trim()),a=t.getSubGroups(),i=t.getElement(),o=[];t.getTable().getColumns().forEach(e=>{e.getVisibility()&&o.push(e.getField())});var s=[];if(0===a.length){t.getRows().forEach(e=>{s.push(function(e,t){var n={};for(var a in t)-1!==e.indexOf(a)&&(n[a]=t[a]);return n}(o,e.getData()))});var r=t.getKey();M(s=h.csvParseRows(l.a.unparse(s)),n.join("_")+"_"+r)}else i.classList.add("shaker"),setTimeout(()=>{i.classList.remove("shaker")},400)}}}(a,s)),d=(r.getColumns().filter(e=>!e.getVisibility()).map(e=>e.getField()),r.getColumns().filter(e=>e.getVisibility()).map(e=>e.getField()));function p(){var t=e("#filter-field").val();"function"===e("#filter-field").val()?(e("#filter-type").prop("disabled",!0),e("#filter-value").prop("disabled",!0)):(e("#filter-type").prop("disabled",!1),e("#filter-value").prop("disabled",!1)),r.setFilter(t,e("#filter-type").val(),e("#filter-value").val())}(function(e,t,n,a){n>1e3?setTimeout(()=>{e.replaceData(t).then(function(){document.getElementById("rowsTotal").innerHTML=t.length,console.log("replaceData done!"),document.getElementById("spinnerLoad-span").classList.replace("inline","hidden"),document.getElementById("filesNumber").classList.add("hidden"),document.getElementById("guide-btn").classList.remove("hidden")}).catch(function(e){console.log(e)})},a):(document.getElementById("spinnerLoad-span").classList.replace("inline","hidden"),document.getElementById("filesNumber").classList.add("hidden"),document.getElementById("guide-btn").classList.remove("hidden"),console.log("table done!"))})(r,t,i,1e3),e("#filter-field, #filter-type").change(p),e("#filter-value").keyup(p),e("#filter-clear").click(function(){e("#filter-field").val("Student ID"),e("#filter-type").val("like"),e("#filter-value").val(""),r.clearFilter()}),document.getElementById("filtersHeader-clear").onclick=function(e){r.clearHeaderFilter()},document.getElementById("groupBy-btn").onclick=function(e){var t=document.getElementById("groupBy-input").value,n=[];if(t){var n=c.compact(t.split(/[\;\,\>]+/));(n=n.map(e=>m.trim(e)).filter(e=>-1!=o.indexOf(e))).length>0&&(r.setGroupBy(n),this.innerHTML='<i class="fas fa-lock"></i>')}},document.getElementById("groupBy-btn").onmouseover=function(e){var t=document.getElementById("groupBy-input").value?"grouper par: "+document.getElementById("groupBy-input").value:"grouper par entête";e.target.title=t},document.getElementById("degroupBy-btn").onclick=function(e){document.getElementById("groupBy-input").value="",r.setGroupBy(""),document.getElementById("groupsNumber").innerHTML="",document.getElementById("groupBy-btn").innerHTML='<i class="fas fa-lock-open"></i>',document.getElementById("groupBy-btn").title="grouper par entête"},document.getElementById("hide-col").onclick=function(){var e=[];r.getColumns().forEach(t=>{t.getVisibility()&&e.push(t.getField())}),q(["","colonnes"],e,"pvtTable",r,"hide"),e=null},document.getElementById("show-col").onclick=function(){var e=[];r.getColumns().forEach(t=>{t.getVisibility()||e.push(t.getField())}),q(["","colonnes"],e,"pvtTable",r,"show"),e=null},document.getElementById("showConcat-col").onclick=function(){if(document.getElementById("spinnerLoad-span").classList.replace("hidden","inline"),"without"===this.dataset.state){var e=d.concat(["Grade","Enrollment Track","Verification Status","Enrollment Status"]);setTimeout(()=>{o.forEach(t=>{-1!==e.indexOf(t)?r.showColumn(t):r.hideColumn(t)}),document.getElementById("spinnerLoad-span").classList.replace("inline","hidden"),this.firstChild.classList.replace("fa-grip-lines-vertical","fa-grip-lines"),this.dataset.state="with",r.redraw()},10)}else setTimeout(()=>{o.forEach(e=>{-1!==d.indexOf(e)?r.showColumn(e):r.hideColumn(e)}),document.getElementById("spinnerLoad-span").classList.replace("inline","hidden"),this.firstChild.classList.replace("fa-grip-lines","fa-grip-lines-vertical"),this.dataset.state="without",r.redraw()},10)},e("#deselectAll-rows").click(function(){r.deselectRow()}),document.getElementById("exportCSV-btn").onclick=function(e){r.download("csv","export-grades.csv",{delimiter:","})},document.getElementById("exportCSVComma-btn").onclick=function(e){document.getElementById("spinnerLoad-span").classList.replace("hidden","inline"),setTimeout(()=>{var e=f();e.slice(1,e.length).forEach(e=>{for(var t=0,n=e.length;t<n;t++)-1===e[t].indexOf(".")||isNaN(parseFloat(e[t]))||(e[t]=parseFloat(e[t]).toLocaleString("fr-FR"))}),M(e,"global_reportTC"),document.getElementById("spinnerLoad-span").classList.replace("inline","hidden")},100)};var f=function(){var e=r.getData(!0),t=r.getSelectedData(),n=(e.filter(e=>-1!==t.indexOf(e)),s.filter((e,t)=>t<38).map(e=>e.field)),a=e.map(e=>Object.keys(e).filter(e=>n.includes(e)).reduce((t,n)=>(t[n]=e[n],t),{})),i=h.csvParseRows(l.a.unparse(a));return i};setTimeout(()=>{n>0&&(document.getElementById("absences").innerHTML=n)},10)}(h.csvParse(l.a.unparse(i)),E)}(i,a)}).catch(function(e){console.log(e),swal({title:"Information error",text:e.toString(),icon:"warning"})})}(t,n)}else D("Information nombre fichiers","Apparemment, il y a plus de 17 fichiers importés...","warning")}).catch(function(e){console.log(e),D("Information erreur","Oups! "+e,"warning")})};const F=["id","username","name","email"],v=["Student ID","Email","year_of_birth","Name","Username","Cohort Name","Pre MOOC","Évaluation Hebdo 1: Évaluation (notée)","Évaluation Hebdo 2: Évaluation (notée)","Évaluation Hebdo 3: Évaluation (notée)","Évaluation Hebdo 4: Évaluation (notée)","Évaluation Hebdo (Avg)","Examen Final","Livrables 1: Carte Conceptuelle - (Semaine 1)","Livrables 2: Compte-rendu - (Semaine 2)","Livrables 3: Planification - (Semaine 3)","Livrables (Avg)","DFS - Diagnostic de Fonctionnement d'un Système","MCB - Management de la Créativité et Brainstorming","MEP - Management d'Équipe Projet","IEF - Les outils informatiques & Évaluer financièrement les projets","PMI - Certifications professionnelles PMI®","AF - Analyse Fonctionnelle","AS - Analyse Stratégique dans les Projets","EIP - Évaluation d'Impact des Projets","PAV - Planification Avancée","MVP - Management Visuel de Projet","GPAS - Gestion de projet agile avec Scrum","MRP - Outils et Méthodologie de Résolution de Problème","TRIZ - Introduction aux principaux outils de TRIZ","G2C - Gestion de crise","PAE - Du Projet à l'Action Entrepreneuriale","Grade","Enrollment Track","Verification Status","Certificate Eligible","Certificate Delivered","Certificate Type","Enrollment Status","fichiers fusionnés","Grade_TC"],b=["Grade TC","Évaluation Hebdo 1: Évaluation (notée)","Évaluation Hebdo 2: Évaluation (notée)","Évaluation Hebdo 3: Évaluation (notée)","Évaluation Hebdo 4: Évaluation (notée)","Évaluation Hebdo (Avg)","Examen Final","Livrables 1: Carte Conceptuelle - (Semaine 1)","Livrables 2: Compte-rendu - (Semaine 2)","Livrables 3: Planification - (Semaine 3)","Livrables (Avg)","DFS - Diagnostic de Fonctionnement d'un Système","MCB - Management de la Créativité et Brainstorming","MEP - Management d'Équipe Projet","IEF - Les outils informatiques & Évaluer financièrement les projets","PMI - Certifications professionnelles PMI®","AF - Analyse Fonctionnelle","AS - Analyse Stratégique dans les Projets","EIP - Évaluation d'Impact des Projets","PAV - Planification Avancée","MVP - Management Visuel de Projet","GPAS - Gestion de projet agile avec Scrum","MRP - Outils et Méthodologie de Résolution de Problème","TRIZ - Introduction aux principaux outils de TRIZ","G2C - Gestion de crise","PAE - Du Projet à l'Action Entrepreneuriale","Pre MOOC"],y={};v.forEach(e=>{y[e]=""});const E={"-TC_":1,"_SPE-DFS_":2,"_SPE-MCB_":3,"_SPE-MEP_":4,"_SPE-IEF_":5,"_SPE-PMI_":6,"_SPE-AF_":7,"_SPE-AS_":8,"_SPE-EIP_":9,"_SPE-PAV_":10,"_SPE-MVP_":11,"_SPE-GPAS_":12,"_SPE-MRP_":13,"_SPE-TRIZ_":14,"_SPE-G2C_":15,"_SPE-PAE_":16,"-PA_":17},x=/(SPE-\w{2,4}|PA_\d{2}|TC_\d{2})_/,C=/(_SPE-\w{2,4}|\-PA|\-TC)_/,P=/\b[A-Z0-9]{2,4}\b\s\-/,I=/^Évaluation Hebdo [1|2|3|4]\:/,w=/^Livrables [1|2|3]\:/,N=(h.format(".2f"),h.format(".0%"));function S(e,t,n,a){var i=(e,t)=>e.replace(t,"").trim();return/(\>\=)/.test(e)?+t>=+i(e,">="):/(\<\=)/.test(e)?+t<=+i(e,"<="):/(\!\=)/.test(e)?+t!=+i(e,"!="):/\>(?!=)/.test(e)?+t>+i(e,">"):/\<(?!=)/.test(e)?+t<+i(e,"<"):!!/(?<!\<|>)\=(?!\>)/.test(e)&&+t==+i(e,"=")}function B(e){var t=document.getElementById("groupBy-input").value?document.getElementById("groupBy-input").value+" > "+e:e;document.getElementById("groupBy-input").value=t.replace(/^[\s\>]/,"")}function L(e){return P.test(e)?e.match(P)[0].replace(/\s\-/,""):I.test(e)?e.match(I)[0].replace(/\:/,""):w.test(e)?e.match(w)[0].replace(/\:/,""):e}function A(e){for(var t=/(<([^>]+)>)/gi,n=/^[0-9]+([,][0-9]+)?%?$/,a=/^[0-9]+([.][0-9]+)?%?$/,i=[],l=0,o=e.length;l<o;l++)isNaN(Number(e[l]))&&n.test(e[l])&&!a.test(e[l])?e[l]=parseFloat(e[l].replace(/\,/,".")).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}):"0"===e[l]||" "===e[l]?e[l]="":"Not Attempted"===e[l]||"Not Available"===e[l]?e[l]="":e[l]=e[l].replace(t,""),i.push(e[l]);return i}function T(e){return isNaN(parseFloat(e))?e:parseFloat(e).toLocaleString("fr-FR")}function k(e){for(var t=-1,n=e?e.length:0,a=-1,i=[];++t<n;){var l=e[t];l&&(i[++a]=l)}return i}function M(e,t){var n=l.a.unparse(e),i=new Blob(["\ufeff"+n],{type:"text/csv;charset=utf-8"});a()(i,t+".csv")}function D(e,t,n){swal({title:e,text:t,icon:n}).then(e=>{setTimeout(()=>window.location.href=window.location.href,10)})}function O(t,n,a){var i=document.createElement("div"),l=(document.createElement("p"),'<table class="'+a+' tableForSweet" style="margin:5px auto">');return l+="<thead><tr>",t.forEach(e=>{l+="<th>"+e+"</th>"}),l+="</tr></thead>",l+="<tbody>",n.forEach(e=>{l+="<tr>",l+="<td>"+e[0]+"</td>",l+="<td>"+e[1]+"</td>",l+="</tr>"}),l+="</tbody></table>",i.appendChild(e.parseHTML(l)[0]),swal({title:"Info participant",text:"",content:i,className:"sweetalert-auto",buttons:{export:"export CSV",annuler:!0}}).then(e=>{switch(e){case"export":n.unshift(t),M(n,"participant_info")}}),!0}function _(t,n,a,i,l){var o,s=document.createElement("div"),r=(document.createElement("p"),l),d='<table class="'+a+' tableForSweet" style="margin:5px auto">';return d+="<thead><tr>",n.forEach(e=>{d+="<th>"+e+"</th>"}),d+="</tr></thead>",d+="<tbody>",t.forEach(e=>{d+="<tr>",e.forEach(e=>{d+="<td>"+e+"</td>"}),d+="</tr>"}),d+="</tbody></table>",s.appendChild(e.parseHTML(d)[0]),swal({title:r,text:i||"",content:s,className:"sweetalert-auto",buttons:{export:"export CSV",annuler:!0}}).then(e=>{switch(e){case"export":(o=t.map(e=>e.map(e=>T(e)))).unshift(n),M(o,r)}}),!0}u.prototype.extendModule("format","formatters",{numberfmt:function(e,t){return/\,/g.test(e.getValue())?e.getValue().split(",").map(e=>isNaN(parseFloat(e))?"":N(parseFloat(e))).join(", "):isNaN(parseFloat(e.getValue()))?e.getValue():N(parseFloat(e.getValue()))},checkfiles:function(e,t){return e.getValue()}});var q=function(t,n,a,i,l){var o=document.createElement("div"),s=(document.createElement("p"),"hide"===l?{hide:"masquer",annuler:!0}:{show:"afficher",annuler:!0}),r='<table class="'+a+' tableForSweet" style="margin:5px auto">';return r+="<thead><tr>",t.forEach((e,t)=>{r+=0===t?'<th id="th_'+t+'"><input type="checkbox" style="width:15px; opacity: 1; height: 1.5em; margin-top: -0.7em" id="checkAll"/></th>':'<th id="th_'+t+'">'+e+"</th>"}),r+="</tr></thead>",r+="<tbody>",n.forEach(e=>{r+="<tr>",r+='<td><input type="checkbox" style="width:15px; opacity: 1; height: 1.5em" class="checkboxColumn" value="'+e+'"/></td>',r+="<td>"+e+"</td>",r+="</tr>"}),r+="</tbody></table>",o.appendChild(e.parseHTML(r)[0]),setTimeout(()=>{document.getElementById("checkAll").addEventListener("click",function(t){e(":checkbox").prop("checked",this.checked)},!1)},10),swal({title:"",text:"",content:o,className:"sweetalert-auto",buttons:s}).then(e=>{switch(e){case"hide":for(var t=0,n=(a=document.getElementsByClassName("checkboxColumn")).length;t<n;++t)a[t].checked&&i.hideColumn(a[t].value);swal("Terminé !","","success");break;case"show":var a;for(t=0,n=(a=document.getElementsByClassName("checkboxColumn")).length;t<n;++t)a[t].checked&&i.showColumn(a[t].value);swal("Terminé !","","success")}}),!0};var R=function(e,t,n,a){var i;if(t.length>1&&2===t[0].length){i=t.length-1+" "+e;_(t.slice(1,t.length),t[0],"pvtTable",i,e)}else if(t.length>1&&t[0].length>=9){i=t.length-1+" "+e+" => "+a;_(t.slice(1,t.length),t[0],"pvtTable",i,e)}else p.innerHTML="",html.appendChild(p),i="0 "+e+' trouvé (recherche par "Student ID")',function(e,t,n,a,i){swal({title:e,text:t,content:n,icon:a,className:i}).then(e=>{})}(title,i,html,"success",i)};e(()=>{document.getElementById("guide-btn").onclick=function(e){var t=introJs();t.setOptions({tooltipPosition:"top",nextLabel:"suivant",prevLabel:"retour",skipLabel:"sortir",doneLabel:"ok",showProgress:!0,showStepNumbers:!1,steps:[{intro:'<p>Bienvenue dans la visite guidée</p><p>Vous pouvez interrompre la visite à tout moment et y revenir quand vous voulez en cliquant sur "Guide"</p>'},{element:"#deselectAll-rows",intro:"Désélectionne toutes les lignes sélectionnées (surlignées en bleu dans le tableau)",position:"top"},{element:"#showConcat-col",intro:'Affiche ou masque les colonnes concaténées "Grade", "Enrollment Track", "Verification Status", "Enrollment Status"',position:"top"},{element:"#show-col",intro:"Affiche un popup pour cocher les colonnes à afficher",position:"top"},{element:"#hide-col",intro:"Affiche un popup pour cocher les colonnes à masquer",position:"top"},{element:"#filter-field",intro:"Liste déroulante<ul><li>Applique un filtre sur l'ensemble du tableau en fonction de la colonne sélectionnée dans la liste</li></ul>",position:"top"},{element:"#filter-type",intro:'Choisir "like" pour filtrer du texte ou un opérateur pour filtrer des nombres',position:"top"},{element:"#filter-value",intro:"Saisir du texte ou des nombres selon le type de filtre sélectionné",position:"top"},{element:"#filter-clear",intro:"Efface le filtre et réinitialise la liste déroulante et le type de filtre sur les éléments ci-contre (à gauche)",position:"top"},{element:"#filtersHeader-clear",intro:"Efface tous les filtres en entête de colonne",position:"top"},{element:"#groupBy-input",intro:'Case de saisie à 2 fonctions (regrouper les lignes du tableau par entête.s de colonnes):<ol><li>Saisie automatique "indirecte" par un CLIC DROIT successivement sur un ou plusieurs entêtes de colonne</li><li>Saisie manuelle d\'un entête de colonne à la condition que le texte saisi soit identique y compris la casse</li></ol>',position:"top"},{element:"#groupBy-btn",intro:"Groupe les lignes du tableau en fonction des entêtes saisis dans la case ci-contre (à gauche)",position:"top"},{element:"#degroupBy-btn",intro:"Dégroupe toutes les lignes groupées du tableau et efface la sélection dans la case ci-contre (à gauche)",position:"top"},{element:"#selectCohortes-btn",intro:"Sélectionne un entête de colonne pour avoir des indicateurs statistiques calculés sur les valeurs contenues dans la colonne",position:"top"},{element:"#cohortes-btn",intro:"Permet de visualiser des indicateurs statistiques par cohorte calculés sur la colonne sélectionnée ci-contre (à gauche) et de les exporter en csv",position:"top"},{element:"#finalStandard-btn",intro:'Export csv des données traitées au format "Final-standard" (Florence). Les données ne sont visualisables qu\'après export',position:"top"},{element:"#exportCSVComma-btn",intro:'Export CSV des données (décimales en virgule).<br>Toutes les colonnes et lignes (visibles ou pas) sont pris en compte à l\'exception des colonnes "concaténées".',position:"top"},{element:"#exportCSV-btn",intro:"Export CSV des données filtrées (décimales en point).<br>Seules les lignes et les colonnes visibles dans le tableau sont pris en compte dans le fichier de sortie",position:"top"},{element:".tabulator-header-filter",intro:'Filtre dynamique à 3 possibiltés:<ol><li> ... filtrage à partir de caractères alphanumériques. Prévoir une légère latence qui permet la prise en compte en cours de saisie</li><li> >= chiffre seulement par saisie directe ou en utilisant les flèches (à droite) pour incrémenter ou décrémenter</li><li> > ou < ou =  saisir un des 3 signes pour "strictement" suivi d\'une valeur en fonction du contenu de la colonne</li></ol>',position:"top"},{element:".tabulator-cell",intro:"Clic droit sur la cellule pour visualiser la fiche participant et l'exporter en CSV le cas échéant",position:"top"},{element:".tabulator-footer",intro:"Divers indicateurs actualisés en temps réel (aucune action requise)",position:"top"}],hints:[{element:"#checkFiles-btn",hint:"Si erreur dans l'ordre des fichiers, un bouton clignotant apparaît qui permet de télécharger la liste des lignes concernées",position:"top"}]}),t.oncomplete(function(){}),t.onexit(function(){}),t.onchange(function(e){}),t.onafterchange(function(e){}),t.onbeforechange(function(e){}),t.start()}})}.call(this,n(172))},176:function(e,t,n){var a=n(75);"string"==typeof a&&(a=[[e.i,a,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0},l=n(56)(a,i);a.locals&&(e.exports=a.locals),e.hot.accept(75,function(){var t=n(75);if("string"==typeof t&&(t=[[e.i,t,""]]),!function(e,t){var n,a=0;for(n in e){if(!t||e[n]!==t[n])return!1;a++}for(n in t)a--;return 0===a}(a.locals,t.locals))throw new Error("Aborting CSS HMR due to changed css-modules locals.");l(t)}),e.hot.dispose(function(){l()})},75:function(e,t,n){(t=e.exports=n(49)(!1)).i(n(177),""),t.push([e.i,"body {\n  padding: 5px;\n}\n\n.introjs-helperNumberLayer {\n  top: 30px !important;\n  left: 50px !important;\n}\n\n.introjs-tooltip  {\n  min-width: 300px !important;\n}\n\n.footerInfo {\n  float: left;\n  color: #555;\n  font-weight: normal;\n}\n\n.mainButton {\n  background: linear-gradient(to bottom, rgb(128,128,128)0%, rgb(16,16,16) 100%);\n}\n\n.tabulator-page {\n  color: #555 !important;\n}\n\n.large {\n  font-size: 1.5em;\n}\n\n.medium {\n  font-size: 1em;\n}\n\n.small {\n  font-size: .70em;\n}\n\n.labelFileInput {\n  cursor: pointer;\n}\n\n#fileInput,\n#fileInputMappage {\n  opacity: 0;\n  position: absolute;\n  z-index: -1;\n}\n\n.inline {\n  display: inline-block;\n}\n\n.hidden {\n  display: none;\n}\n\nlabel {\n  white-space: nowrap;\n  margin-right: .5em;\n  padding: 2px\n}\n\n.labelProfile {\n  color: red;\n  font-weight: 900;\n}\n\n.normal {\n  color: #222;\n  font-weight: normal;\n}\n\n.blink {\n  animation-duration: 1s;\n  animation-name: blinker;\n  animation-direction: linear;\n  animation-iteration-count: infinite;\n}\n\n@keyframes blinker {\n  50% {\n      opacity: 0;\n  }\n}\n\n@keyframes spin {\n  0% {\n      transform: rotate(0deg);\n  }\n\n  100% {\n      transform: rotate(360deg);\n  }\n}\n\n.shaker {\n  animation: shake 0.75s cubic-bezier(.36, .07, .19, .97) both;\n  background-color: #FFE5E4;\n}\n\n@keyframes shake {\n\n  10%,\n  90% {\n      transform: translate3d(-1px, 0, 0);\n  }\n\n  20%,\n  80% {\n      transform: translate3d(2px, 0, 0);\n  }\n\n  30%,\n  50%,\n  70% {\n      transform: translate3d(-4px, 0, 0);\n  }\n\n  40%,\n  60% {\n      transform: translate3d(4px, 0, 0);\n  }\n}\n\n/* table pvt et sweetAlert */\n\n.swal-content {\n  background-color: #E6F5F5;\n  padding: 2px;\n  border: #BED7F5 solid 1px;\n  border-radius: 5px;\n  display: block;\n  margin: 5px;\n  text-align: justify;\n  color: #61534e;\n}\n\n.swal-content h4 {\n  text-align: center;\n}\n\n.swal-button {\n  padding: 2px 5px;\n}\n\n.sweetalert-lg {\n  width: 800px;\n}\n\n.sweetalert-auto {\n  width: auto;\n}\n\n.sweetalert-img {\n  text-align: center;\n  width: 1024px;\n}\n\n.sweetalert-table {\n  text-align: center;\n  width: 1366px;\n}\n\n/*  for create table */\n\ntable.pvtTable {\n  font-size: 8pt;\n  text-align: left;\n  border-collapse: collapse;\n}\n\ntable.pvtTable thead tr th {\n  background-color: #F0F5FE;\n  color: #555;\n  border: 1px solid #CDCDCD;\n  padding: 2px;\n}\n\ntable.pvtTable thead tr th:first-child {\n  width: auto;\n  min-width: 20px;\n}\n\ntable.pvtTable tbody tr th {\n  background-color: #F0F5FE;\n  color: #555;\n  border: 1px solid #CDCDCD;\n  padding: 2px;\n  text-align: left;\n  vertical-align: top;\n}\n\ntable.pvtTable tbody tr td {\n  color: #3D3D3D;\n  padding: 2px;\n  background-color: #FFF;\n  border: 1px solid #CDCDCD;\n  vertical-align: top;\n}\n\ntable.pvtTable tbody tr td:first-child {\n  width: auto;\n  min-width: 20px;\n}\n",""])}},[[171,37,26,14,13,25,4,18,11,12,15,10,9,5,6,8,16,17,20,34,22,27,7,32,36,1,2,29,3,19,21,23,24,28,30,31,33,35]]]);