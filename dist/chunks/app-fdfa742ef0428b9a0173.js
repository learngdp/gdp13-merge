(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{164:function(e,t,n){"use strict";n.r(t);n(165),n(167),n(168),n(170);var a=n(8),i=n.n(a),o=n(159),l=n.n(o),s=n(13),r=n.n(s),u=(n(403),n(94)),c=n(160),d=n(161);console.log(lang,locale),document.addEventListener("touchstart",function e(t){document.documentElement.classList.add("can-touch"),document.removeEventListener("touchstart",e,!1)},!1);var m=n(171),h=(n(172),n(286)),f=n(355);const g=Object.assign({},n(21),n(409),n(2),n(408),n(5),n(66),n(407),n(406));var v;u.b.add(c.a,d.a),u.a.watch(),window.addEventListener("load",function(){document.getElementById("main_div").style.display="block"}),console.log(lang,locale);function F(e){return new Promise(function(t,n){var a=new FileReader;a.onload=(a=>{var i=a.target.result;let o,l={};r.a.parse(i,{header:!0,dynamicTyping:!0,skipEmptyLines:!0,chunk:function(a,i){(o=function(e,t){var n;return e.forEach(function(e,a){if(y[y.indexOf(e.trim())],-1===y.indexOf(e.trim())){var i=document.createElement("div"),o=document.createElement("p");e=e&&" "!==e?e:"au moins une colonne ou un entête vide",o.innerHTML="<h4 Fichier concerné:<br><b>"+t.name+"</b><br><br>Entête concerné:<br><b>"+e+"</b></h4><hr>",o.innerHTML+='<h4 style="color:red"> <i class="fa fa-warning"></i><br>entêtes en cours au '+(new Date).toLocaleDateString()+"</h4><br><br>",o.innerHTML+=JSON.stringify(y.map(e=>"["+e+"]").join(", ")),i.appendChild(o),function(e,t,n,a){swal({title:e,text:t,content:n,icon:a,className:"sweetalert-lg"}).then(e=>{setTimeout(()=>window.location.href=window.location.href,10)})}("Contrôle entête de colonnes","Oups! Apparemment, un entête de colonne n'est pas conforme au modèle attendu... ",i,"warning"),n=!1}else n=!0}),n}(a.meta.fields,e))?(l[e.name]=a.data,l.headers=a.meta.fields,t(l)):n("erreur entêtes de colonnes")},complete:function(t){console.log("done! ",e.name,new Date-v+"ms")}})}),a.onprogress=(e=>{}),a.readAsText(e,"UTF-8"),0})}function b(e,t){for(var n,a=[],i=0,o=e.length;i<o;i++)n=e[i][t],a.push(n);return T(a)}fileInput.onchange=function(e){v=new Date,document.getElementById("spinnerLoad-span").classList.replace("hidden","inline"),this.disabled=!0;var t=[...fileInput.files];(t=t.sort(function(e,t){return e=I.test(e.name)?e.name.match(I)[0]:e.name,t=I.test(t.name)?t.name.match(I)[0]:t.name,P[e]-P[t]})).map(e=>e.size).reduce((e,t)=>e+=t);let n=[];for(var a=0,o=t.length;a<o;a++)n.push(F(t[a]));Promise.all(n).then(function(e){let t=[...new Set([].concat(...e.map(e=>e.headers)))];setTimeout(()=>{!function(e,t){document.getElementById("grade_report-div").classList.replace("inline","hidden"),document.getElementById("profil_info-div").classList.replace("hidden","inline"),document.getElementById("spinnerLoad-span").classList.replace("inline","hidden"),function(e,t){return console.log("flatData: "+(new Date-v)+"ms"),new Promise(function(n){var a=[],o=[];e.length>1?e.forEach(e=>{a.push(e[Object.keys(e)[0]].map(t=>(w.test(Object.keys(e)[0])&&(t["filename imported"]=Object.keys(e)[0].match(w)[0].replace(/[\d+_]/g,"").replace(/SPE\-/,"")),t)))}):a.push(e[0][Object.keys(e[0])[0]].map(t=>(w.test(Object.keys(e[0])[0])&&(t["filename imported"]=Object.keys(e[0])[0].match(w)[0].replace(/[\d+_]/g,"").replace(/SPE\-/,"")),t)));var l=[].concat(...a),s={};t.forEach((e,t)=>{s[e]=""});for(var p=0,u=l.length;p<u;p++)o.push(Object.assign({},s,l[p]));var c,d,m,h=function(e,t){document.getElementById("filter-field").value,e.push("fichiers fusionnés");var n=g.csvParse(r.a.unparse(t)),a={};e.forEach((e,t)=>{a[e]=""});for(var i=[],o=g.nest().key(e=>e["Student ID"]).rollup(t=>{var n=t.map(e=>[].concat.call([],Object.values(e)));return n.unshift(e),{arr:n}}).entries(n),l=0,s=o.length;l<s;l++){var p=o[l],u=p.value.arr,c={};e.forEach((e,t)=>{c[e]="Grade"==e||"Enrollment Track"==e||"Enrollment Status"==e||"fichiers fusionnés"==e?b(u.slice(1,u.length),t):[...new Set(b(u.slice(1,u.length),t))]}),i.push(Object.assign({},a,c))}return g.csvParseRows(r.a.unparse(i))}(t,o).sort((e,t)=>e[0]-t[0]);d=(c=h)[0].map(e=>e.trim()),m=[],c.forEach((e,t)=>{0===t||void 0===e[0]||""===e[0]||e[0].match(/^(\r\n|\r|\n)$/)||(e[0]=e[0].trim(),m.push(e))}),m.unshift(d),h=m;var f=function(e){var t=r.a.parse(e).meta.delimiter,a=g.dsvFormat(t).parseRows(e,function(e){if(e&&void 0!==e&&0!==e[0].length)return e}).sort((e,t)=>e[0]-t[0]),o=g.csvParse(r.a.unparse(a));void 0!==a&&function(e){console.time("import");var t=!0;return e[0].slice(0,4).forEach(e=>{-1===x.indexOf(e)&&(t=!1)}),t||swal({title:"Fichier profile_info",text:"Un des champs en entête des 4 premières colonnes ne correspond pas au champs attendus dans l'ordre suivant:\n[id] [username] [name] [email]",icon:"warning"}).then(e=>{document.getElementById("profil_info-div").firstElementChild.classList.replace("normal","labelProfile"),i()(".fa-arrow-alt-circle-right").addClass("blink"),document.getElementById("spinnerLoad-span").classList.replace("inline","hidden"),document.getElementById("fileInputMappage").disabled=!1}),t}(a)&&n({flat:h,dataMappage:o})};document.getElementById("fileInputMappage").onchange=function(e){this.disabled=!0,document.getElementById("spinnerLoad-span").classList.replace("hidden","inline"),document.getElementById("profil_info-div").classList.replace("inline","hidden");var t=this.files[0],n=new FileReader;n.onprogress=function(e){},n.onloadend=function(e){},n.onload=function(e){f(n.result)},n.readAsText(t)}})}(e,t).then(function(e){var t=g.csvParse(r.a.unparse(e.flat)),n=e.dataMappage,a=t.map(function(e,t){var a;e.Username&&void 0!==e.Username&&(a=isNaN(e.Username)?e.Username:e.Username.toString());var i=n.find(e=>e.username===a),o=n.find(t=>t.email===e.Email);e.Name=void 0===i||void 0===o?"":i.name;var l=n.find(t=>t.id===e["Student ID"]);return void 0===l?e.Name="Absent sur profile_info":(e.Name=l.name,e.year_of_birth=l.year_of_birth?l.year_of_birth:""),function(e,t){return t.reduce((n,a)=>{t.indexOf(a);return n[a]=e[a],n},{})}(e,y)});setTimeout(()=>{(function(e,t){var n=g.csvParseRows(r.a.unparse(e)),a=n.map(e=>(function(e){for(var t=/(<([^>]+)>)/gi,n=/^[0-9]+([,][0-9]+)?%?$/,a=/^[0-9]+([.][0-9]+)?%?$/,i=[],o=0,l=e.length;o<l;o++)isNaN(Number(e[o]))&&n.test(e[o])&&!a.test(e[o])?e[o]=parseFloat(e[o].replace(/\,/,".")).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}):"0"===e[o]||" "===e[o]?e[o]="":"Not Attempted"===e[o]||"Not Available"===e[o]?e[o]="":e[o]=e[o].replace(t,""),i.push(e[o]);return i})(e)),o=i()("#selectCohortes-btn");o.find("option").remove();for(var l=0,s=E.length;l<s;l++)o.append('<option value="'+E[l]+'">'+E[l]+"</option>");var p=[...new Set(a.map(e=>e[5]))],u=p[0];p=p.slice(1,p.length);var c=document.getElementById("cohortes-btn");c.innerHTML=p.length+' cohortes <i class="fas fa-download"></i>';var d=[a[0].slice(17,32)],F=a.slice(1,a.length).map(e=>e.slice(17,32).map(e=>isNaN(parseFloat(e))?0:parseFloat(e)));a[0].splice(6,0,"Attestation PC"),a[0].splice(7,0,"Attestation PA"),a[0].splice(8,0,"Grade TC"),a[0].splice(10,0,"1ère SPE"),a[0].splice(11,0,"2ème SPE"),a[0].splice(12,0,"SPE validées");for(var b,x,y=0,l=0,s=a.slice(1,a.length).length;l<s;l++){var N=(b=a.slice(1,a.length)[l])[5],P=null!=b[6]?b[6].split(","):"",w=b[16],I=null!=b[33]?b[33].split(","):"",C=null!=b[39]?b[39].split(","):"",B={};I.forEach((e,t)=>{B[C[t]]=e}),"Absent sur profile_info"===b[3]&&y++,x=F[l].filter(e=>e>.695).length;var M=Math.max.apply(null,F[l]),_=M>.695&&-1!==F[l].indexOf(M)?d[0][F[l].indexOf(M)]:"";F[l].length>1&&-1!==F[l].indexOf(M)&&F[l].splice(F[l].indexOf(M),1,0);var O,q,R=Math.max.apply(null,F[l]),G=R>.695&&-1!==F[l].indexOf(R)?d[0][F[l].indexOf(R)]:"";G===_&&(G=""),_=S.test(_)?_.match(S)[0].replace(/\s\-/,""):_,G=S.test(G)?G.match(S)[0].replace(/\s\-/,""):G;var H=""!=P&&+P[0]>=.7&&x>=2,V=""!=P&&+P[0]>=.7&&x>=2&&w>=.7,U="verified"==B.TC&&"verified"==B[_]&&"verified"==B[G],z="verified"!=B.TC||"verified"!=B[_]||"verified"!=B[G];O=H&&U?"OUI":H&&""!=N?"OUI":H&&z?"en attente":"NON",q=V&&U?"OUI":V&&""!=N?"OUI":V&&z?"en attente":"NON",b.splice(6,0,O),b.splice(7,0,q),b.splice(8,0,P[0]),b.splice(10,0,_),b.splice(11,0,G),b.splice(12,0,x)}return setTimeout(()=>{!function(e,t){console.log("start "+(new Date-v)+"ms");var n=e.length>1e3?e.slice(0,1e3):e.slice(0,e.length),a=e.slice(0,e.length).length-n.length,o=e.columns;!function(e){e.forEach(e=>{i()("#filter-field").append('<option value="'+e+'" style="max-width:100px;">'+A(e)+"</option>")}),["like","=","<","<=",">",">=","!="].forEach(e=>{i()("#filter-type").append('<option value="'+e+'" style="max-width:100px;">'+e+"</option>")})}(o);var l=function(e){var t,n=[];return e.forEach((a,o)=>{t=A(a),a==e[0]?n.push({id:o,title:t,field:a,frozen:!0,headerFilter:"input",cellContext:function(e,t){var n,a,o,l,s,r=Object.entries(t.getRow().getData());n=["entête","valeur"],a=r,o="pvtTable",l=document.createElement("div"),document.createElement("p"),s='<table class="'+o+' tableForSweet" style="margin:5px auto">',s+="<thead><tr>",n.forEach(e=>{s+="<th>"+e+"</th>"}),s+="</tr></thead>",s+="<tbody>",a.forEach(e=>{s+="<tr>",s+="<td>"+e[0]+"</td>",s+="<td>"+e[1]+"</td>",s+="</tr>"}),s+="</tbody></table>",l.appendChild(i.a.parseHTML(s)[0]),swal({title:"Info participant",text:"",content:l,className:"sweetalert-auto",buttons:{export:"export CSV",annuler:!0}}).then(e=>{switch(e){case"export":a.unshift(n),k(a,"participant_info")}}),e.preventDefault()},headerContext:function(e,t){e.preventDefault(),D(t.getField())}}):a==e[1]?n.push({id:o,title:t,field:a,frozen:!0,width:150,headerFilter:"input",headerContext:function(e,t){e.preventDefault(),D(t.getField())}}):a==e[2]?n.push({id:o,title:t,field:a,visible:!1,headerFilter:"input",headerContext:function(e,t){e.preventDefault(),D(t.getField())}}):a==e[3]||a==e[4]?n.push({id:o,title:t,field:a,width:150,headerFilter:"input",headerContext:function(e,t){e.preventDefault(),D(t.getField())}}):o>12&&o<18?n.push({id:o,title:t,field:a,formatter:"numberfmt",visible:!1,headerFilter:"input",headerContext:function(e,t){e.preventDefault(),D(t.getField())}}):9==o||18==o||8===o?n.push({id:o,title:t,field:a,formatter:"numberfmt",headerFilter:"input",headerContext:function(e,t){e.preventDefault(),D(t.getField())}}):o>18&&o<39?n.push({id:o,title:t,field:a,formatter:"numberfmt",visible:!1,headerFilter:"input",headerContext:function(e,t){e.preventDefault(),D(t.getField())}}):o>39&&o<44?n.push({id:o,title:t,field:a,visible:!1,headerFilter:"input",headerContext:function(e,t){e.preventDefault(),D(t.getField())}}):n.push({id:o,title:t,field:a,headerFilter:"input",headerContext:function(e,t){e.preventDefault(),D(t.getField())}})}),n}(o),s=l.filter(e=>null!=e.visible&&!e.visible).map(e=>e.field),p=new m("#table-app",function(e,t){var n='<div class="footerInfo"> ';return n+='<a type="button" href="https://github.com/olifolkerd/tabulator" target="_blank" style="margin-right: 3em; padding: 2px 5px; font-weight: 900">Tabulator</a>',n+='lignes: <span id="rowsTotal" style="font-weight: 900">'+e.length+"</span>",n+='<span style="margin-left: 1em">colonnes: </span><span id="columnsTotal" style="font-weight: 900">'+t.length+"</span>",n+='<div style="margin-left: 4em;" class="inline">',n+='<span>lignes: </span><span id="rowsCount" style="font-weight: 900"></span> (filtrée.s)',n+='<span style="margin-left: 2em">sélection: </span><span id="rowSelected" style="font-weight: 900"></span> (ligne.s)',n+='<span style="margin-left: 2em">total absence.s: </span><span id="absences" style="font-weight: 900; color:red"></span>',n+='</div><div style="margin-left: 4em;" class="inline">',n+='<span style="margin-left: 2em">groupe.s: </span><span id="groupsNumber" style="font-weight: 900"></span>',n+="</div></div>",{selectable:!0,height:Math.round(window.innerHeight)-50,data:e,reactiveData:!0,tooltipsHeader:!0,columns:t,pagination:"local",paginationSize:50,movableColumns:!0,headerFilterPlaceholder:"...",footerElement:n,history:!0,tooltips:!0,initialSort:[{column:"Student ID",dir:"asc"}],rowClick:function(e,t){},rowSelectionChanged:function(e,t){document.getElementById("rowSelected").innerHTML=e.length},dataFiltered:function(e,t){document.getElementById("rowsCount").innerHTML=t.length},groupStartOpen:function(e,t,n,a){return!1},groupHeader:function(e,t,n,a){var i=document.getElementById("groupBy-input").value;return 0==a.getSubGroups().length?"<span style='color:#0000FFFF; margin-right: 5px;' title='clic droit pour export'>"+i+"</span> : "+e+"<span style='color:#d00; margin-left:10px;'>("+t+" item)</span>":"<span style='color:#0000FFFF; margin-right: 5px;'>"+i+"</span> : "+e+"<span style='color:#d00; margin-left:10px;'>("+t+" item)</span>"},groupContext:function(e,t){e.preventDefault();var n=document.getElementById("groupBy-input").value;n=n.split(">").map(e=>e.trim());var a=[],i=t.getSubGroups(),o=t.getElement();if(0==i.length){t.getRows().forEach(e=>{a.push(e.getData())});var l=t.getKey();k(a=g.csvParseRows(r.a.unparse(a)),n.join("_")+"_"+l)}else o.classList.add("shaker"),setTimeout(()=>{o.classList.remove("shaker")},400)}}}(n,l));function u(){var e=i()("#filter-field").val();"function"==i()("#filter-field").val()?(i()("#filter-type").prop("disabled",!0),i()("#filter-value").prop("disabled",!0)):(i()("#filter-type").prop("disabled",!1),i()("#filter-value").prop("disabled",!1)),p.setFilter(e,i()("#filter-type").val(),i()("#filter-value").val())}console.log("tabulator "+(new Date-v)+"ms"),function(e,t,n,a){n>1e3?setTimeout(()=>{e.replaceData(t).then(function(){document.getElementById("rowsTotal").innerHTML=t.length,console.log("replaceData done!"),console.log("replaceData "+(new Date-v)+"ms"),document.getElementById("spinnerLoad-span").classList.replace("inline","hidden"),document.getElementById("guide-btn").classList.remove("hidden")}).catch(function(e){console.log(e)})},a):(console.log("replaceData "+(new Date-v)+"ms"),document.getElementById("spinnerLoad-span").classList.replace("inline","hidden"),document.getElementById("guide-btn").classList.remove("hidden"))}(p,e,a,1e3),i()("#filter-field, #filter-type").change(u),i()("#filter-value").keyup(u),i()("#filter-clear").click(function(){i()("#filter-field").val("Student ID"),i()("#filter-type").val("like"),i()("#filter-value").val(""),p.clearFilter()}),document.getElementById("groupBy-btn").onclick=function(e){var t=document.getElementById("groupBy-input").value,n=[];if(t){var n=h.compact(t.split(/[\;\,\>]+/));(n=n.map(e=>f.trim(e)).filter(e=>-1!=o.indexOf(e))).length>0&&(p.setGroupBy(n),this.innerHTML='<i class="fas fa-lock"></i>')}},document.getElementById("groupBy-btn").onmouseover=function(e){var t=document.getElementById("groupBy-input").value?"grouper par: "+document.getElementById("groupBy-input").value:"grouper par entête";e.target.title=t},document.getElementById("degroupBy-btn").onclick=function(e){document.getElementById("groupBy-input").value="",p.setGroupBy(""),document.getElementById("groupBy-btn").innerHTML='<i class="fas fa-lock-open"></i>',document.getElementById("groupBy-btn").title="grouper par entête"},document.getElementById("hide-col").onclick=function(){let e=document.getElementById("filter-field").value;p.hideColumn(e)},document.getElementById("show-col").onclick=function(){let e=document.getElementById("filter-field").value;p.showColumn(e)},document.getElementById("showAll-coll").onclick=function(){document.getElementById("spinnerLoad-span").classList.replace("hidden","inline"),setTimeout(()=>{o.forEach(e=>{p.showColumn(e)}),document.getElementById("spinnerLoad-span").classList.replace("inline","hidden")},10)},document.getElementById("hideAll-coll").onclick=function(){document.getElementById("spinnerLoad-span").classList.replace("hidden","inline"),setTimeout(()=>{s.forEach(e=>{p.hideColumn(e)}),document.getElementById("spinnerLoad-span").classList.replace("inline","hidden")},10)},i()("#deselectAll-rows").click(function(){p.deselectRow()}),document.getElementById("exportCSV-btn").onclick=function(e){p.download("csv","export-grades.csv",{delimiter:","})},setTimeout(()=>{t>0&&(document.getElementById("absences").innerHTML=t)},10)}(g.csvParse(r.a.unparse(a)),y)},100),document.getElementById("finalStandard-btn").onclick=function(e){!function(e,t){document.getElementById("spinnerLoad-span").classList.replace("hidden","inline");for(var n,a,i,o=[e[0].slice(17,32)],l=e.slice(1,e.length).sort(function(e,t){return e[0]-t[0]}),s=/^[0-9]+([.][0-9]+)?%?$/,r=([].concat.apply([],l.map(function(e){return e.filter(function(e){return s.test(e)&&(t=e.valueOf())-Math.floor(t)!=0&&Number.isInteger(parseInt(e));var t})})),l.map(e=>e.slice(17,32).map(e=>isNaN(parseFloat(e))?0:parseFloat(e)))),p=l.map(e=>e.slice(7,11).map(e=>isNaN(parseFloat(e))?0:parseFloat(e))),u=l.map(e=>e.slice(12,13).map(e=>isNaN(parseFloat(e))?0:parseFloat(e))),c=l.map(e=>e.slice(13,16).map(e=>isNaN(parseFloat(e))?0:parseFloat(e))),d=0,m=l.length;d<m;d++){n=l[d][3],a=l[d][5],i=r[d].filter(e=>e>.695).length;var h=Math.max.apply(null,r[d]),f=h>.695&&-1!==r[d].indexOf(h)?o[0][r[d].indexOf(h)]:"";r[d].length>1&&-1!==r[d].indexOf(h)&&r[d].splice(r[d].indexOf(h),1,0);var v=Math.max.apply(null,r[d]),F=v>.695&&-1!==r[d].indexOf(v)?o[0][r[d].indexOf(v)]:"";F===f&&(F=""),f=S.test(f)?f.match(S)[0].replace(/\s\-/,""):f,F=S.test(F)?F.match(S)[0].replace(/\s\-/,""):F;var b=t.find(e=>e.id===l[d][0]);b=b&&void 0!==b?b.email:"",l[d].splice(2,1,n),l[d].splice(3,1,b),l[d].splice(4,1,a),g.sum(p[d])/4>.695&&u[d][0]>.695&&i>=2?l[d].splice(5,1,"OUI"):l[d].splice(5,1,"NON"),(g.sum(p[d])+g.sum(c[d]))/7>.695&&u[d][0]>.695&&i>=2?l[d].splice(6,1,"OUI"):l[d].splice(6,1,"NON"),isNaN(parseFloat(l[d][7]))?l[d].push(""):l[d].push(L(parseFloat(100*l[d][7]).toFixed(2))),isNaN(parseFloat(l[d][7]))?l[d].push(""):l[d].push(L(parseFloat(100*l[d][7]/5).toFixed(2))),isNaN(parseFloat(l[d][8]))?l[d].push(""):l[d].push(L(parseFloat(100*l[d][7]).toFixed(2))),isNaN(parseFloat(l[d][8]))?l[d].push(""):l[d].push(L(parseFloat(100*l[d][8]/5).toFixed(2))),isNaN(parseFloat(l[d][9]))?l[d].push(""):l[d].push(L(parseFloat(100*l[d][9]).toFixed(2))),isNaN(parseFloat(l[d][9]))?l[d].push(""):l[d].push(L(parseFloat(100*l[d][9]/5).toFixed(2))),isNaN(parseFloat(l[d][10]))?l[d].push(""):l[d].push(L(parseFloat(100*l[d][10]).toFixed(2))),isNaN(parseFloat(l[d][10]))?l[d].push(""):l[d].push(L(parseFloat(100*l[d][10]/5).toFixed(2))),isNaN(parseFloat(l[d][12]))?l[d].push(""):l[d].push(L(parseFloat(100*l[d][12]).toFixed(2))),isNaN(parseFloat(l[d][12]))?l[d].push(""):l[d].push(L(parseFloat(100*l[d][12]/5).toFixed(2))),isNaN(parseFloat(l[d][13]))?l[d].push(""):l[d].push(L(parseFloat(100*l[d][13]).toFixed(2))),isNaN(parseFloat(l[d][13]))?l[d].push(""):l[d].push(L(parseFloat(100*l[d][13]/5).toFixed(2))),isNaN(parseFloat(l[d][14]))?l[d].push(""):l[d].push(L(parseFloat(100*l[d][14]).toFixed(2))),isNaN(parseFloat(l[d][14]))?l[d].push(""):l[d].push(L(parseFloat(100*l[d][14]/5).toFixed(2))),isNaN(parseFloat(l[d][15]))?l[d].push(""):l[d].push(L(parseFloat(100*l[d][15]).toFixed(2))),isNaN(parseFloat(l[d][15]))?l[d].push(""):l[d].push(L(parseFloat(100*l[d][15]/5).toFixed(2))),isNaN(parseFloat(l[d][17]))?l[d].push(""):l[d].push(L(parseFloat(100*l[d][17]).toFixed(2))),isNaN(parseFloat(l[d][17]))?l[d].push(""):l[d].push(L(parseFloat(100*l[d][17]/5).toFixed(2))),isNaN(parseFloat(l[d][18]))?l[d].push(""):l[d].push(L(parseFloat(100*l[d][18]).toFixed(2))),isNaN(parseFloat(l[d][18]))?l[d].push(""):l[d].push(L(parseFloat(100*l[d][18]/5).toFixed(2))),isNaN(parseFloat(l[d][19]))?l[d].push(""):l[d].push(L(parseFloat(100*l[d][19]).toFixed(2))),isNaN(parseFloat(l[d][19]))?l[d].push(""):l[d].push(L(parseFloat(100*l[d][19]/5).toFixed(2))),isNaN(parseFloat(l[d][20]))?l[d].push(""):l[d].push(L(parseFloat(100*l[d][20]).toFixed(2))),isNaN(parseFloat(l[d][20]))?l[d].push(""):l[d].push(L(parseFloat(100*l[d][20]/5).toFixed(2))),isNaN(parseFloat(l[d][21]))?l[d].push(""):l[d].push(L(parseFloat(100*l[d][21]).toFixed(2))),isNaN(parseFloat(l[d][21]))?l[d].push(""):l[d].push(L(parseFloat(100*l[d][21]/5).toFixed(2))),isNaN(parseFloat(l[d][22]))?l[d].push(""):l[d].push(L(parseFloat(100*l[d][22]).toFixed(2))),isNaN(parseFloat(l[d][22]))?l[d].push(""):l[d].push(L(parseFloat(100*l[d][22]/5).toFixed(2))),isNaN(parseFloat(l[d][23]))?l[d].push(""):l[d].push(L(parseFloat(100*l[d][23]).toFixed(2))),isNaN(parseFloat(l[d][23]))?l[d].push(""):l[d].push(L(parseFloat(100*l[d][23]/5).toFixed(2))),isNaN(parseFloat(l[d][24]))?l[d].push(""):l[d].push(L(parseFloat(100*l[d][24]).toFixed(2))),isNaN(parseFloat(l[d][24]))?l[d].push(""):l[d].push(L(parseFloat(100*l[d][24]/5).toFixed(2))),isNaN(parseFloat(l[d][25]))?l[d].push(""):l[d].push(L(parseFloat(100*l[d][25]).toFixed(2))),isNaN(parseFloat(l[d][25]))?l[d].push(""):l[d].push(L(parseFloat(100*l[d][25]/5).toFixed(2))),isNaN(parseFloat(l[d][26]))?l[d].push(""):l[d].push(L(parseFloat(100*l[d][26]).toFixed(2))),isNaN(parseFloat(l[d][26]))?l[d].push(""):l[d].push(L(parseFloat(100*l[d][26]/5).toFixed(2))),isNaN(parseFloat(l[d][27]))?l[d].push(""):l[d].push(L(parseFloat(100*l[d][27]).toFixed(2))),isNaN(parseFloat(l[d][27]))?l[d].push(""):l[d].push(L(parseFloat(100*l[d][27]/5).toFixed(2))),isNaN(parseFloat(l[d][28]))?l[d].push(""):l[d].push(L(parseFloat(100*l[d][28]).toFixed(2))),isNaN(parseFloat(l[d][28]))?l[d].push(""):l[d].push(L(parseFloat(100*l[d][28]/5).toFixed(2))),isNaN(parseFloat(l[d][29]))?l[d].push(""):l[d].push(L(parseFloat(100*l[d][29]).toFixed(2))),isNaN(parseFloat(l[d][29]))?l[d].push(""):l[d].push(L(parseFloat(100*l[d][29]/5).toFixed(2))),isNaN(parseFloat(l[d][30]))?l[d].push(""):l[d].push(L(parseFloat(100*l[d][30]).toFixed(2))),isNaN(parseFloat(l[d][30]))?l[d].push(""):l[d].push(L(parseFloat(100*l[d][30]/5).toFixed(2))),isNaN(parseFloat(l[d][31]))?l[d].push(""):l[d].push(L(parseFloat(100*l[d][31]).toFixed(2))),isNaN(parseFloat(l[d][31]))?l[d].push(""):l[d].push(L(parseFloat(100*l[d][31]/5).toFixed(2))),l[d].splice(7,33),i?l[d].push(i.toFixed(0)):l[d].push(""),l[d].push(f),l[d].push(F),i&&i>=2?l[d].push(""):l[d].push("< 2"),g.sum(p[d])/4>.695?l[d].push(""):l[d].push("< 70%"),u[d][0]>.695?l[d].push(""):l[d].push("< 70%"),(g.sum(p[d])+g.sum(c[d]))/7>.695?l[d].push(""):l[d].push("< 70%"),3===c[d].filter(e=>0!==e).length?l[d].push(""):l[d].push("< 3")}e.splice(0,1);var x=e;x.unshift(["Student ID","Email","Étudiant","Mail d'inscription","Cohorte","Classique","Avancé","S1 (%)","S1 (/20)","S2 (%)","S2 (/20)","S3 (%)","S3 (/20)","S4 (%)","S4 (/20)","Examen Final (%)"," Examen Final (/20)","Devoir 1 (%)","Devoir 1 (/20)","Devoir 2 (%)","Devoir 2 (/20)","Devoir 3 (%)","Devoir 3 (/20)","Diagnostic de Fonctionnement Système\n01 - DFS (%)","Diagnostic de Fonctionnement Système\n01 - DFS (/20)","Management Créativité & Brainstorming\n02 - MCB (%)","Management Créativité & Brainstorming\n02 - MCB (/20)","Management d'Équipe-Projet\n03 - MEP (%)","Management d'Équipe-Projet\n03 - MEP (/20)","Outils Informatiques & Évaluation Financière\n04 - IEF (%)","Outils Informatiques & Évaluation Financière\n04 - IEF (/20)","Certification professionnelle PMI®\n05 - PMI (%)","Certification professionnelle PMI®\n05 - PMI (/20)","Analyse Fonctionnelle\n06 - AF (%)","Analyse Fonctionnelle\n06 - AF (/20)","Analyse Stratégique\n07 - AS (%)","Analyse Stratégique\n07 - AS (/20)","Évaluation d'Impact des Projets\n08 - EIP (%)","Évaluation d'Impact des Projets\n08 - EIP (/20)","Planification Avancée\n09 - PAV (%)","Planification Avancée\n09 - PAV (/20)","Management Visuel de Projet\n10 - MVP (%)","Management Visuel de Projet\n10 - MVP (/20)","Gestion de Projet Agile avec Scrum\n11 - GPAS (%)","Gestion de Projet Agile avec Scrum\n11 - GPAS (/20)","Méthode de Résolution de Problèmes\n12 - MRP (%)","Méthode de Résolution de Problèmes\n12 - MRP (/20)","Résolution Créative de Problèmes : TRIZ\n13 - TRIZ (%)","Résolution Créative de Problèmes : TRIZ\n13 - TRIZ (/20)","Gestion De Crise\n14 - G2C (%)","Gestion De Crise\n14 - G2C (/20)","Action Entrepreneuriale\n15 - PAE (%)","Action Entrepreneuriale\n15 - PAE (/20)","Nombre\nmodules réussis","Meilleur\nmodule réussi 1","Meilleur\nmodule réussi 2","Causes Échec\n(PC & PA) Modules","Causes Échec\n(PC ) Moyenne Quiz","Causes Échec\n(PC & PA) Examen final","Causes Échec\n(PA) Moyenne Quiz & Devoirs","Causes Échec\n(PA) Devoirs"]),setTimeout(()=>{k(x,"final-standard"),document.getElementById("spinnerLoad-span").classList.replace("inline","hidden")},100)}(n,t)},c.onclick=function(e){var t=document.getElementById("selectCohortes-btn").value,n=function(e,t,n){var a=g.nest().key(e=>e[n]).rollup(e=>{var n=e.map(e=>isNaN(parseFloat(e[t]))?0:Math.round(100*parseFloat(e[t]))/100);n.sort();var a=T(n),i=a.length>=1?parseFloat(g.median(a)):0,o=a.length>=1?parseFloat(g.min(a)):0,l=a.length>=1?parseFloat(g.max(a)):0,s=a.length>=1?parseFloat(g.mean(a)):0,r=a.length>1?parseFloat(g.quantile(a,.25)):0,p=a.length>1?parseFloat(g.quantile(a,.75)):0,u=a.length>1?parseFloat(g.quantile(a,.1)):0,c=a.length>1?parseFloat(g.quantile(a,.9)):0,d=a.length>1?parseFloat(g.variance(a)):0,m=a.length>1?parseFloat(g.deviation(a)):0;return{gradesFull:n.length,grades:a.length,min:0!==o?o.toFixed(2):"",max:0!==l?l.toFixed(2):"",avg:0!==s?s.toFixed(2):"",median:0!==i?i.toFixed(2):"",quartileFirst:0!==r?r.toFixed(2):"",quartileThird:0!==p?p.toFixed(2):"",decileFirst:0!==u?u.toFixed(2):"",decileLast:0!==c?c.toFixed(2):"",variance:0!==d?d.toFixed(2):"",deviation:0!==m?m.toFixed(2):""}}).entries(e),i=[["cohorte","participants","actifs","min","max","moyenne","médiane","1er quartile","3ème quartile","1er décile","9ème décile","variance","écart-type"]];return a.forEach(e=>{var t=e.key,n=e.value;n.grades,i.push([t,n.gradesFull,n.grades,n.min,n.max,n.avg,n.median,n.quartileFirst,n.quartileThird,n.decileFirst,n.decileLast,n.variance,n.deviation])}),i}(g.csvParse(r.a.unparse(a)),t,u);console.log(n),setTimeout(()=>{j("cohortes (détails)",n,this,t)},100)},console.log("globalReport end "+(new Date-v)+"ms"),!0})(a,n)&&console.log("tabulator launch !"+(new Date-v)+"ms")},10)}).catch(function(e){console.log(e),swal({title:"Information error",text:e.toString(),icon:"warning"})})}(e,t)},10)}).catch(function(e){console.log(e),swal({title:"Information erreur",text:"Oups! "+e,icon:"warning"}).then(e=>{setTimeout(()=>window.location.href=window.location.href,10)})}),console.log("timeProcess: "+(new Date-v)+"ms")};const x=["id","username","name","email"],y=["Student ID","Email","year_of_birth","Name","Username","Cohort Name","Grade","Évaluation Hebdo 1: Évaluation (notée)","Évaluation Hebdo 2: Évaluation (notée)","Évaluation Hebdo 3: Évaluation (notée)","Évaluation Hebdo 4: Évaluation (notée)","Évaluation Hebdo (Avg)","Examen Final","Livrables 1: Carte Conceptuelle - (Semaine 1)","Livrables 2: Compte-rendu - (Semaine 2)","Livrables 3: Planification - (Semaine 3)","Livrables (Avg)","DFS - Diagnostic de Fonctionnement d'un Système","MCB - Management de la Créativité et Brainstorming","MEP - Management d'Équipe Projet","IEF - Les outils informatiques & Évaluer financièrement les projets","PMI - Certifications professionnelles PMI®","AF - Analyse Fonctionnelle","AS - Analyse Stratégique dans les Projets","EIP - Évaluation d'Impact des Projets","PAV - Planification Avancée","MVP - Management Visuel de Projet","GPAS - Gestion de projet agile avec Scrum","MRP - Outils et Méthodologie de Résolution de Problème","TRIZ - Introduction aux principaux outils de TRIZ","G2C - Gestion de crise","PAE - Du Projet à l'Action Entrepreneuriale","Pre MOOC","Enrollment Track","Verification Status","Certificate Eligible","Certificate Delivered","Certificate Type","Enrollment Status","fichiers fusionnés"],E=["Grade","Évaluation Hebdo 1: Évaluation (notée)","Évaluation Hebdo 2: Évaluation (notée)","Évaluation Hebdo 3: Évaluation (notée)","Évaluation Hebdo 4: Évaluation (notée)","Évaluation Hebdo (Avg)","Examen Final","Livrables 1: Carte Conceptuelle - (Semaine 1)","Livrables 2: Compte-rendu - (Semaine 2)","Livrables 3: Planification - (Semaine 3)","Livrables (Avg)","DFS - Diagnostic de Fonctionnement d'un Système","MCB - Management de la Créativité et Brainstorming","MEP - Management d'Équipe Projet","IEF - Les outils informatiques & Évaluer financièrement les projets","PMI - Certifications professionnelles PMI®","AF - Analyse Fonctionnelle","AS - Analyse Stratégique dans les Projets","EIP - Évaluation d'Impact des Projets","PAV - Planification Avancée","MVP - Management Visuel de Projet","GPAS - Gestion de projet agile avec Scrum","MRP - Outils et Méthodologie de Résolution de Problème","TRIZ - Introduction aux principaux outils de TRIZ","G2C - Gestion de crise","PAE - Du Projet à l'Action Entrepreneuriale","Pre MOOC"],N={};y.forEach(e=>{N[e]=""});const P={"-TC_":1,"_SPE-DFS_":2,"_SPE-MCB_":3,"_SPE-MEP_":4,"_SPE-IEF_":5,"_SPE-PMI_":6,"_SPE-AF_":7,"_SPE-AS_":8,"_SPE-EIP_":9,"_SPE-PAV_":10,"_SPE-MVP_":11,"_SPE-GPAS_":12,"_SPE-MRP_":13,"_SPE-TRIZ_":14,"_SPE-G2C_":15,"_SPE-PAE_":16,"-PA_":17},w=/(SPE-\w{2,4}|PA_\d{2}|TC_\d{2})_/,I=/(_SPE-\w{2,4}|\-PA|\-TC)_/,S=/\b[A-Z0-9]{2,4}\b\s\-/,C=/^Évaluation Hebdo [1|2|3|4]\:/,B=/^Livrables [1|2|3]\:/,M=(g.format(".2f"),g.format(".0%"));function D(e){var t=document.getElementById("groupBy-input").value?document.getElementById("groupBy-input").value+" > "+e:e;document.getElementById("groupBy-input").value=t.replace(/^[\s\>]/,"")}function A(e){return S.test(e)?e.match(S)[0].replace(/\s\-/,""):C.test(e)?e.match(C)[0].replace(/\:/,""):B.test(e)?e.match(B)[0].replace(/\:/,""):e}function L(e){return isNaN(parseFloat(e))?e:parseFloat(e).toLocaleString("fr-FR")}function T(e){for(var t=-1,n=e?e.length:0,a=-1,i=[];++t<n;){var o=e[t];o&&(i[++a]=o)}return i}function k(e,t){var n=r.a.unparse(e),a=new Blob(["\ufeff"+n],{type:"text/csv;charset=utf-8"});l()(a,t+".csv")}function _(e,t,n,a,i){swal({title:e,text:t,content:n,icon:a,className:i}).then(e=>{})}function O(e,t,n,a){var o,l=document.createElement("div"),s=(document.createElement("p"),a),r='<table class="'+n+' tableForSweet" style="margin:5px auto">';return r+="<thead><tr>",t.forEach(e=>{r+="<th>"+e+"</th>"}),r+="</tr></thead>",r+="<tbody>",e.forEach(e=>{r+="<tr>",e.forEach(e=>{r+="<td>"+e+"</td>"}),r+="</tr>"}),r+="</tbody></table>",l.appendChild(i.a.parseHTML(r)[0]),swal({title:s,text:void 0,content:l,className:"sweetalert-auto",buttons:{export:"export CSV",annuler:!0}}).then(n=>{switch(n){case"export":(o=e.map(e=>e.map(e=>L(e)))).unshift(t),k(o,s)}}),!0}m.prototype.extendModule("format","formatters",{numberfmt:function(e,t){return/\,/g.test(e.getValue())?e.getValue().split(",").map(e=>isNaN(parseFloat(e))?"":M(parseFloat(e))).join(", "):isNaN(parseFloat(e.getValue()))?e.getValue():M(parseFloat(e.getValue()))}});var j=function(e,t,n,a){var i;if(t.length>1&&2===t[0].length){i=t.length-1+" "+e;O(t.slice(1,t.length),t[0],"pvtTable",i)}else if(t.length>1&&t[0].length>=9){i=t.length-1+" "+e+" => "+a;O(t.slice(1,t.length),t[0],"pvtTable",i)}else p.innerHTML="",html.appendChild(p),i="0 "+e+' trouvé (recherche par "Student ID")',_(title,i,html,"success",i)};i()(()=>{document.getElementById("guide-btn").onclick=function(e){var t=introJs();t.setOptions({tooltipPosition:"top",nextLabel:"suivant",prevLabel:"retour",skipLabel:"sortir",doneLabel:"ok",showProgress:!0,showStepNumbers:!1,steps:[{intro:'<p>Bienvenue dans la visite guidée</p><p>Vous pouvez interrompre la visite à tout moment et y revenir quand vous voulez en cliquant sur "Guide"</p>'},{element:"#deselectAll-rows",intro:"Désélectionne toutes les lignes sélectionnées (surlignées en bleu dans le tableau)",position:"top"},{element:"#showAll-coll",intro:"Affiche toutes les colonnes",position:"top"},{element:"#hideAll-coll",intro:"Masque toutes les colonnes qui sont masquées au démarrage de l'application",position:"top"},{element:"#show-col",intro:"Affiche la colonne sélectionnnée dans la liste déroulante ci-contre (à droite)",position:"top"},{element:"#hide-col",intro:"Masque la colonne sélectionnnée idem dans la liste déroulante ci-contre (à droite)",position:"top"},{element:"#filter-field",intro:'Liste déroulante à 2 fonctions:<ol><li>Permet de sélectionner une colonne pour l\'afficher ou la masquer (comme vu précédemment)</li><li></li>Applique un filtre "général" sur le tableau en fonction de la colonne sélectionnée</li></ol>',position:"top"},{element:"#filter-type",intro:'Choisir "like" pour filtrer du texte ou un opérateur pour filtrer des nombres',position:"top"},{element:"#filter-value",intro:"Saisir du texte ou des nombres selon le type de filtre sélectionné",position:"top"},{element:"#filter-clear",intro:"Efface le filtre et réinitialise la liste déroulante et le type de filtre sur les éléments ci-contre (à gauche)",position:"top"},{element:"#groupBy-input",intro:'Case de saisie à 2 fonctions (regrouper les lignes du tableau par entête.s de colonnes):<ol><li>Saisie automatique "indirecte" par un CLIC DROIT successivement sur un ou plusieurs entêtes de colonne</li><li>Saisie manuelle d\'un entête de colonne à la condition que le texte saisi soit identique y compris la casse</li></ol>',position:"top"},{element:"#groupBy-btn",intro:"Groupe les lignes du tableau en fonction des entêtes saisis dans la case ci-contre (à gauche)",position:"top"},{element:"#degroupBy-btn",intro:"Dégroupe toutes les lignes groupées du tableau et efface la sélection dans la case ci-contre (à gauche)",position:"top"},{element:"#selectCohortes-btn",intro:"Sélectionne un entête de colonne pour avoir des indicateurs statistiques calculés sur les valeurs contenues dans la colonne",position:"top"},{element:"#cohortes-btn",intro:"Permet de visualiser des indicateurs statistiques par cohorte calculés sur la colonne sélectionnée ci-contre (à gauche) et de les exporter en csv",position:"top"},{element:"#finalStandard-btn",intro:'Export csv des données traitées au format "Final-standard" (Florence). Les données ne sont visualisables qu\'après export',position:"top"},{element:"#exportCSV-btn",intro:"Export CSV des données filtrées. Seules les lignes et les colonnes visibles sont pris en compte dans le fichier de sortie",position:"top"},{element:".tabulator-header-filter",intro:"Filtre dynamique (sans opérateur)",position:"top"},{element:".tabulator-cell",intro:"Clic droit sur la cellule pour visualiser la fiche participant et l'exporter en CSV le cas échéant",position:"top"},{element:".tabulator-footer",intro:"Divers indicateurs actualisés en temps réel",position:"top"}],hints:[{element:".tabulator-header-filter",hint:"More features, more fun.",position:"left"}]}),t.oncomplete(function(){}),t.onexit(function(){}),t.onchange(function(e){}),t.onafterchange(function(e){}),t.onbeforechange(function(e){}),t.start()}})},168:function(e,t,n){var a=n(70);"string"==typeof a&&(a=[[e.i,a,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0},o=n(51)(a,i);a.locals&&(e.exports=a.locals),e.hot.accept(70,function(){var t=n(70);if("string"==typeof t&&(t=[[e.i,t,""]]),!function(e,t){var n,a=0;for(n in e){if(!t||e[n]!==t[n])return!1;a++}for(n in t)a--;return 0===a}(a.locals,t.locals))throw new Error("Aborting CSS HMR due to changed css-modules locals.");o(t)}),e.hot.dispose(function(){o()})},70:function(e,t,n){(t=e.exports=n(43)(!1)).i(n(169),""),t.push([e.i,"body {\n  padding: 5px;\n}\n\n.introjs-helperNumberLayer {\n  top: 30px !important;\n  left: 50px !important;\n}\n\n.introjs-tooltip  {\n  min-width: 300px !important;\n}\n\n.footerInfo {\n  float: left;\n  color: #555;\n  font-weight: normal;\n}\n\n.mainButton {\n  background: linear-gradient(to bottom, rgb(128,128,128)0%, rgb(16,16,16) 100%);\n}\n\n.tabulator-page {\n  color: #555 !important;\n}\n\n.large {\n  font-size: 1.5em;\n}\n\n.medium {\n  font-size: 1em;\n}\n\n.small {\n  font-size: .70em;\n}\n\n.labelFileInput {\n  cursor: pointer;\n}\n\n#fileInput,\n#fileInputMappage {\n  opacity: 0;\n  position: absolute;\n  z-index: -1;\n}\n\n.inline {\n  display: inline-block;\n}\n\n.hidden {\n  display: none;\n}\n\nlabel {\n  white-space: nowrap;\n  margin-right: .5em;\n  padding: 2px\n}\n\n.labelProfile {\n  color: red;\n  font-weight: 900;\n}\n\n.normal {\n  color: #222;\n  font-weight: normal;\n}\n\n.blink {\n  animation-duration: 1s;\n  animation-name: blinker;\n  animation-direction: linear;\n  animation-iteration-count: infinite;\n}\n\n@keyframes blinker {\n  50% {\n      opacity: 0;\n  }\n}\n\n@keyframes spin {\n  0% {\n      transform: rotate(0deg);\n  }\n\n  100% {\n      transform: rotate(360deg);\n  }\n}\n\n.shaker {\n  animation: shake 0.75s cubic-bezier(.36, .07, .19, .97) both;\n  background-color: #FFE5E4;\n}\n\n@keyframes shake {\n\n  10%,\n  90% {\n      transform: translate3d(-1px, 0, 0);\n  }\n\n  20%,\n  80% {\n      transform: translate3d(2px, 0, 0);\n  }\n\n  30%,\n  50%,\n  70% {\n      transform: translate3d(-4px, 0, 0);\n  }\n\n  40%,\n  60% {\n      transform: translate3d(4px, 0, 0);\n  }\n}\n\n/* table pvt et sweetAlert */\n\n.swal-content {\n  background-color: #E6F5F5;\n  padding: 2px;\n  border: #BED7F5 solid 1px;\n  border-radius: 5px;\n  display: block;\n  margin: 5px;\n  text-align: justify;\n  color: #61534e;\n}\n\n.swal-content h4 {\n  text-align: center;\n}\n\n.swal-button {\n  padding: 2px 5px;\n}\n\n.sweetalert-lg {\n  width: 800px;\n}\n\n.sweetalert-auto {\n  width: auto;\n}\n\n.sweetalert-img {\n  text-align: center;\n  width: 1024px;\n}\n\n.sweetalert-table {\n  text-align: center;\n  width: 1366px;\n}\n\n/*  for create table */\n\ntable.pvtTable {\n  font-size: 8pt;\n  text-align: left;\n  border-collapse: collapse;\n}\n\ntable.pvtTable thead tr th {\n  background-color: #F0F5FE;\n  color: #555;\n  border: 1px solid #CDCDCD;\n  padding: 2px;\n}\n\ntable.pvtTable thead tr th:first-child {\n  width: auto;\n}\n\ntable.pvtTable tbody tr th {\n  background-color: #F0F5FE;\n  color: #555;\n  border: 1px solid #CDCDCD;\n  padding: 2px;\n  text-align: left;\n}\n\ntable.pvtTable tbody tr td {\n  color: #3D3D3D;\n  padding: 2px;\n  background-color: #FFF;\n  border: 1px solid #CDCDCD;\n  vertical-align: top;\n}\n\ntable.pvtTable tbody tr td:first-child {\n  width: auto;\n}\n",""])}},[[164,32,21,12,11,2,16,9,10,13,8,7,3,4,6,14,15,18,29,19,22,5,27,31,24,1,17,20,23,25,26,28,30]]]);